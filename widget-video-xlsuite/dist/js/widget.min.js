function loadVideoLinkFromXLSuite(e){var t="2ae45fc2-72b9-45ce-9771-caf0fabf9c97",i="12345";$.ajax({url:"https://rn.xlsuite.com/admin/api/liquids/call?api_key="+t+"&tag=load_screen&display_key="+i}).then(function(t){var i=t.screen.channel_url;console.log("Loaded channel URL",i);var n=i+"&amp;autoplay=1&amp;controls=0&amp;showinfo=0 frameborder=0";e(n)})}if("undefined"==typeof config){var config={SKIN:"skin/RVSkin.xml",STORAGE_ENV:"prod"};"undefined"!=typeof angular&&angular.module("risevision.common.i18n.config",[]).constant("LOCALES_PREFIX","locales/translation_").constant("LOCALES_SUFIX",".json")}var RiseVision=RiseVision||{};RiseVision.Video={},RiseVision.Video=function(e){"use strict";function t(){clearTimeout(L),L=null}function i(){e.rpc.call("","rsevent_done",null,h.getString("id"))}function n(){e.rpc.call("","rsevent_ready",null,h.getString("id"),!0,!0,!0,!0,!0)}function o(e){I=setInterval(function(){A=y.url+w+"cb="+(new Date).getTime(),b=!1},e)}function r(){t(),L=setTimeout(function(){i()},5e3)}function a(){F=!0,A="",V.show("The selected video does not exist."),R.remove(_,function(){S||r()})}function s(e){A=e,V.hide(),S||u()}function l(e){A=e,b=!1}function c(){var e=R.getFrameObject(_);return S=!0,F?(t(),void 0):(e&&e.pause(),void 0)}function u(){var e=R.getFrameObject(_);return S=!1,F?(r(),void 0):(b?i():e?e.play():A&&""!==A&&(R.add(0),R.createFramePlayer(0,y,A,config.SKIN,"player.html")),void 0)}function d(){R.remove(_,function(){i()})}function m(){var e;C||null!==I||o(E),S||(e=R.getFrameObject(_),e.play())}function f(){clearTimeout(T),T=setInterval(function(){console.log("Interval check"),loadVideoLinkFromXLSuite(function(e){if(e!=A){A=e;var t=$("#mainIframe");t.attr("src",A)}})},5e3)}function g(t,i){var o;Array.isArray(t)&&t.length>0&&"additionalParams"===t[0]&&Array.isArray(i)&&i.length>0&&(y=JSON.parse(i[0]),h=new e.Prefs,document.getElementById("videoContainer").style.height=h.getInt("rsH")+"px",y.width=h.getInt("rsW"),y.height=h.getInt("rsH"),R=new RiseVision.Common.Video.FrameController,C=!1,o=y.url.split("?"),w=1===o.length?"?":"&",A=y.url,loadVideoLinkFromXLSuite(function(e){A=e;var t=$("#mainIframe");t.attr("src",A),t.attr("width",y.width),t.attr("height",y.height),f(),n()}))}function p(e){console.debug("video-folder::playerError()",e),b=!0,d()}function v(){c()}var y,h=null,V=null,R=null,b=!1,C=!1,S=!0,_=0,w="",A="",E=9e5,I=null,L=null,F=!1,T=null;return{noStorageFile:a,onStorageInit:s,onStorageRefresh:l,pause:c,play:u,setAdditionalParams:g,playerEnded:d,playerReady:m,playerError:p,stop:v}}(gadgets);var RiseVision=RiseVision||{};RiseVision.Video=RiseVision.Video||{},RiseVision.Video.Storage=function(e){"use strict";function t(){var t=document.getElementById("videoStorage");t&&(t.addEventListener("rise-storage-response",function(e){e.detail&&e.detail.url&&(i?(i=!1,RiseVision.Video.onStorageInit(e.detail.url)):e.detail.hasOwnProperty("changed")&&e.detail.changed&&RiseVision.Video.onStorageRefresh(e.detail.url))}),t.addEventListener("rise-storage-no-file",function(){RiseVision.Video.noStorageFile()}),t.setAttribute("folder",e.storage.folder),t.setAttribute("fileName",e.storage.fileName),t.setAttribute("companyId",e.storage.companyId),t.setAttribute("env",config.STORAGE_ENV),t.go())}var i=!0;return{init:t}};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Video=RiseVision.Common.Video||{},RiseVision.Common.Video.FrameController=function(){"use strict";function e(e){return document.getElementById(l+e)}function t(t){var i,n=e(t);return i=n.querySelector("iframe"),i?i.contentWindow?i.contentWindow:i.contentDocument.document?i.contentDocument.document:i.contentDocument:null}function i(i){var n,o=e(i),r=t(i);r&&(n=o.querySelector("iframe"),r.remove(),n.setAttribute("src","about:blank"))}function n(t){var i=e(t),n=document.createElement("iframe");n.setAttribute("allowTransparency",!0),n.setAttribute("frameborder","0"),n.setAttribute("scrolling","no"),i.appendChild(n)}function o(i,n,o,r,a){var s,l=e(i),c=t(i);c&&(s=l.querySelector("iframe"),s.onload=function(){s.onload=null,c.init(n,o,r),c.load()},s.setAttribute("src",a))}function r(t){var i=e(t);i.style.visibility="hidden"}function a(e,t){var n=document.getElementById(l+e);i(e),setTimeout(function(){for(;n.firstChild;)n.removeChild(n.firstChild);t&&"function"==typeof t&&t()},200)}function s(t){var i=e(t);i.style.visibility="visible"}var l="if_";return{add:n,createFramePlayer:o,getFrameContainer:e,getFrameObject:t,hide:r,remove:a,show:s}};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Message=function(e,t){"use strict";function i(){try{t.style.height=e.style.height}catch(i){console.warn("Can't initialize Message - ",i.message)}}function n(){if(r){for(;t.firstChild;)t.removeChild(t.firstChild);t.style.display="none",e.style.visibility="visible",r=!1}}function o(i){var n,o=document.createDocumentFragment();r?(n=t.querySelector(".message"),n.innerHTML=i):(e.style.visibility="hidden",t.style.display="block",n=document.createElement("p"),n.innerHTML=i,n.setAttribute("class","message"),n.style.lineHeight=t.style.height,o.appendChild(n),t.appendChild(o),r=!0)}var r=!1;return i(),{hide:n,show:o}},function(e,t){"use strict";function i(){RiseVision.Video.play()}function n(){RiseVision.Video.pause()}function o(){RiseVision.Video.stop()}function r(){e.removeEventListener("WebComponentsReady",r),s&&""!==s&&(t.rpc.register("rscmd_play_"+s,i),t.rpc.register("rscmd_pause_"+s,n),t.rpc.register("rscmd_stop_"+s,o),t.rpc.register("rsparam_set_"+s,RiseVision.Video.setAdditionalParams),t.rpc.call("","rsparam_get",null,s,["additionalParams"]))}var a=new t.Prefs,s=a.getString("id");e.oncontextmenu=function(){return!1},e.addEventListener("WebComponentsReady",r)}(window,gadgets);var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57092159-2"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3dpZGdldC5taW4uanMiXSwibmFtZXMiOlsibG9hZFZpZGVvTGlua0Zyb21YTFN1aXRlIiwiY2FsbGJhY2siLCJhcGlLZXkiLCJkaXNwbGF5S2V5IiwiJCIsImFqYXgiLCJ1cmwiLCJ0aGVuIiwiZGF0YSIsImNoYW5lbFVybCIsInNjcmVlbiIsImNoYW5uZWxfdXJsIiwiY29uc29sZSIsImxvZyIsImZ1bGxVcmwiLCJjb25maWciLCJTS0lOIiwiU1RPUkFHRV9FTlYiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uc3RhbnQiLCJSaXNlVmlzaW9uIiwiVmlkZW8iLCJnYWRnZXRzIiwiX2NsZWFyTm9GaWxlVGltZXIiLCJjbGVhclRpbWVvdXQiLCJfbm9GaWxlVGltZXIiLCJfZG9uZSIsInJwYyIsImNhbGwiLCJfcHJlZnMiLCJnZXRTdHJpbmciLCJfcmVhZHkiLCJfcmVmcmVzaEludGVydmFsIiwiZHVyYXRpb24iLCJfcmVmcmVzaEludGVydmFsSWQiLCJzZXRJbnRlcnZhbCIsIl9jdXJyZW50RmlsZSIsIl9hZGRpdGlvbmFsUGFyYW1zIiwiX3NlcGFyYXRvciIsIkRhdGUiLCJnZXRUaW1lIiwiX3BsYXliYWNrRXJyb3IiLCJfc3RhcnROb0ZpbGVUaW1lciIsInNldFRpbWVvdXQiLCJub1N0b3JhZ2VGaWxlIiwiX25vRmlsZUZsYWciLCJfbWVzc2FnZSIsInNob3ciLCJfZnJhbWVDb250cm9sbGVyIiwicmVtb3ZlIiwiX2N1cnJlbnRGcmFtZSIsIl92aWV3ZXJQYXVzZWQiLCJvblN0b3JhZ2VJbml0IiwiaGlkZSIsInBsYXkiLCJvblN0b3JhZ2VSZWZyZXNoIiwicGF1c2UiLCJmcmFtZU9iaiIsImdldEZyYW1lT2JqZWN0IiwiYWRkIiwiY3JlYXRlRnJhbWVQbGF5ZXIiLCJwbGF5ZXJFbmRlZCIsInBsYXllclJlYWR5IiwiX2lzU3RvcmFnZUZpbGUiLCJfcmVmcmVzaER1cmF0aW9uIiwic3RhcnRQbGF5bGlzdENoYW5nZVRpbWVyIiwiX3BsYXlsaXN0Q2hhbmdlVGltZXIiLCJ2aWRlb1VybCIsIiRtYWluSWZyYW1lIiwiYXR0ciIsInNldEFkZGl0aW9uYWxQYXJhbXMiLCJuYW1lcyIsInZhbHVlcyIsInN0ciIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsIkpTT04iLCJwYXJzZSIsIlByZWZzIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInN0eWxlIiwiaGVpZ2h0IiwiZ2V0SW50Iiwid2lkdGgiLCJDb21tb24iLCJGcmFtZUNvbnRyb2xsZXIiLCJzcGxpdCIsInBsYXllckVycm9yIiwiZXJyb3IiLCJkZWJ1ZyIsInN0b3AiLCJTdG9yYWdlIiwiaW5pdCIsInN0b3JhZ2UiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsImRldGFpbCIsIl9pbml0aWFsTG9hZCIsImhhc093blByb3BlcnR5IiwiY2hhbmdlZCIsInNldEF0dHJpYnV0ZSIsImZvbGRlciIsImZpbGVOYW1lIiwiY29tcGFueUlkIiwiZ28iLCJnZXRGcmFtZUNvbnRhaW5lciIsImluZGV4IiwiUFJFRklYIiwiaWZyYW1lIiwiZnJhbWVDb250YWluZXIiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudFdpbmRvdyIsImNvbnRlbnREb2N1bWVudCIsIl9jbGVhciIsImNyZWF0ZUVsZW1lbnQiLCJhcHBlbmRDaGlsZCIsInBhcmFtcyIsImZpbGVzIiwic2tpbiIsInNyYyIsIm9ubG9hZCIsImxvYWQiLCJ2aXNpYmlsaXR5IiwiZmlyc3RDaGlsZCIsInJlbW92ZUNoaWxkIiwiTWVzc2FnZSIsIm1haW5Db250YWluZXIiLCJtZXNzYWdlQ29udGFpbmVyIiwiX2luaXQiLCJ3YXJuIiwibWVzc2FnZSIsIl9hY3RpdmUiLCJkaXNwbGF5IiwicCIsImZyYWdtZW50IiwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudCIsImlubmVySFRNTCIsImxpbmVIZWlnaHQiLCJ3aW5kb3ciLCJwb2x5bWVyUmVhZHkiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiaWQiLCJyZWdpc3RlciIsInByZWZzIiwib25jb250ZXh0bWVudSIsIl9nYXEiLCJwdXNoIiwiZ2EiLCJ0eXBlIiwiYXN5bmMiLCJsb2NhdGlvbiIsInByb3RvY29sIiwicyIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwicGFyZW50Tm9kZSIsImluc2VydEJlZm9yZSJdLCJtYXBwaW5ncyI6IkFBaUJBLFFBQVNBLDBCQUF5QkMsR0FDaEMsR0FBSUMsR0FBUyx1Q0FHVEMsRUFBYSxPQUVqQkMsR0FBRUMsTUFDQUMsSUFBSyx5REFBMkRKLEVBQVMsZ0NBQWtDQyxJQUMxR0ksS0FBSyxTQUFVQyxHQUNoQixHQUFJQyxHQUFZRCxFQUFLRSxPQUFPQyxXQUc1QkMsU0FBUUMsSUFBSSxxQkFBc0JKLEVBRWxDLElBQUlLLEdBQVVMLEVBQVksNkRBRTFCUixHQUFTYSxLQS9CYixHQUFzQixtQkFBWEMsUUFBd0IsQ0FDakMsR0FBSUEsU0FDRkMsS0FBTSxrQkFDTkMsWUFBYSxPQUdRLG9CQUFaQyxVQUNUQSxRQUFRQyxPQUFPLG9DQUNaQyxTQUFTLGlCQUFrQix3QkFDM0JBLFNBQVMsZ0JBQWlCLFNBZ0NqQyxHQUFJQyxZQUFhQSxjQUNqQkEsWUFBV0MsU0FFWEQsV0FBV0MsTUFBUSxTQUFXQyxHQUM1QixZQTZCQSxTQUFTQyxLQUNQQyxhQUFhQyxHQUNiQSxFQUFlLEtBR2pCLFFBQVNDLEtBQ1BKLEVBQVFLLElBQUlDLEtBQUssR0FBSSxlQUFnQixLQUFNQyxFQUFPQyxVQUFVLE9BSTlELFFBQVNDLEtBQ1BULEVBQVFLLElBQUlDLEtBQUssR0FBSSxnQkFBaUIsS0FBTUMsRUFBT0MsVUFBVSxPQUMzRCxHQUFNLEdBQU0sR0FBTSxHQUFNLEdBRzVCLFFBQVNFLEdBQWlCQyxHQUN4QkMsRUFBcUJDLFlBQVksV0FFL0JDLEVBQWVDLEVBQWtCaEMsSUFBTWlDLEVBQWEsT0FBUSxHQUFJQyxPQUFPQyxVQUd2RUMsR0FBaUIsR0FFaEJSLEdBR0wsUUFBU1MsS0FDUG5CLElBRUFFLEVBQWVrQixXQUFXLFdBRXhCakIsS0FDQyxLQU1MLFFBQVNrQixLQUNQQyxHQUFjLEVBQ2RULEVBQWUs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V0FBV0MsTUFBTWlDLE9BR25CLFFBQVNFLEtBQ1BwQyxXQUFXQyxNQUFNbUMsUUFHbkIsUUFBU29DLEtBQ1B4RSxXQUFXQyxNQUFNdUUsT0FHbkIsUUFBU2lELEtBQ1BELEVBQU9FLG9CQUFvQixxQkFBc0JELEdBRTdDRSxHQUFhLEtBQVBBLElBQ1J6SCxFQUFRSyxJQUFJcUgsU0FBUyxjQUFnQkQsRUFBSXpGLEdBQ3pDaEMsRUFBUUssSUFBSXFILFNBQVMsZUFBaUJELEVBQUl2RixHQUMxQ2xDLEVBQVFLLElBQUlxSCxTQUFTLGNBQWdCRCxFQUFJbkQsR0FFekN0RSxFQUFRSyxJQUFJcUgsU0FBUyxlQUFpQkQsRUFBSTNILFdBQVdDLE1BQU1pRCxxQkFDM0RoRCxFQUFRSyxJQUFJQyxLQUFLLEdBQUksY0FBZSxLQUFNbUgsR0FBSyxzQkE3Qm5ELEdBQUlFLEdBQVEsR0FBSTNILEdBQVF5RCxNQUN0QmdFLEVBQUtFLEVBQU1uSCxVQUFVLEtBR3ZCOEcsR0FBT00sY0FBZ0IsV0FDckIsT0FBTyxHQTRCVE4sRUFBTzVDLGlCQUFpQixxQkFBc0I2QyxJQUU3Q0QsT0FBUXRILFFBS1gsSUFBSTZILE1BQU9BLFFBRVhBLE1BQUtDLE1BQU0sY0FBZSxrQkFDMUJELEtBQUtDLE1BQU0sbUJBRVgsV0FDRSxHQUFJQyxHQUFLckUsU0FBU29DLGNBQWMsU0FBV2lDLEdBQUdDLEtBQU8sa0JBQW1CRCxFQUFHRSxPQUFRLEVBQ25GRixFQUFHNUIsS0FBTyxVQUFZekMsU0FBU3dFLFNBQVNDLFNBQVcsY0FBZ0IsY0FBZ0IsNkJBQ25GLElBQUlDLEdBQUkxRSxTQUFTMkUscUJBQXFCLFVBQVUsRUFBSUQsR0FBRUUsV0FBV0MsYUFBYVIsRUFBSUsiLCJmaWxlIjoianMvd2lkZ2V0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGdsb2JhbCBjb25maWc6IHRydWUgKi9cbi8qIGV4cG9ydGVkIGNvbmZpZyAqL1xuaWYgKHR5cGVvZiBjb25maWcgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBTS0lOOiBcInNraW4vUlZTa2luLnhtbFwiLFxuICAgIFNUT1JBR0VfRU5WOiBcInByb2RcIlxuICB9O1xuXG4gIGlmICh0eXBlb2YgYW5ndWxhciAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIGFuZ3VsYXIubW9kdWxlKFwicmlzZXZpc2lvbi5jb21tb24uaTE4bi5jb25maWdcIiwgW10pXG4gICAgICAuY29uc3RhbnQoXCJMT0NBTEVTX1BSRUZJWFwiLCBcImxvY2FsZXMvdHJhbnNsYXRpb25fXCIpXG4gICAgICAuY29uc3RhbnQoXCJMT0NBTEVTX1NVRklYXCIsIFwiLmpzb25cIik7XG4gIH1cbn1cblxyXG4ndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIGxvYWRWaWRlb0xpbmtGcm9tWExTdWl0ZShjYWxsYmFjaykge1xuICB2YXIgYXBpS2V5ID0gXCIyYWU0NWZjMi03MmI5LTQ1Y2UtOTc3MS1jYWYwZmFiZjljOTdcIjtcblxuICAvL3RvZG86IGdldCBkaXNwbGF5IGtleSBmcm9tIHNldHRpbmdzXG4gIHZhciBkaXNwbGF5S2V5ID0gXCIxMjM0NVwiO1xuXG4gICQuYWpheCh7XG4gICAgdXJsOiBcImh0dHBzOi8vcm4ueGxzdWl0ZS5jb20vYWRtaW4vYXBpL2xpcXVpZHMvY2FsbD9hcGlfa2V5PVwiICsgYXBpS2V5ICsgXCImdGFnPWxvYWRfc2NyZWVuJmRpc3BsYXlfa2V5PVwiICsgZGlzcGxheUtleVxuICB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgdmFyIGNoYW5lbFVybCA9IGRhdGEuc2NyZWVuLmNoYW5uZWxfdXJsOyAgLy9odHRwczovL3d3dy55b3V0dWJlLmNvbS9lbWJlZC92aWRlb3Nlcmllcz9saXN0PVBMbjU2VmJ4T1M3N2ZkLXFiWncwbXZuUzJQbV9fdHZTSFpcblxuICAgIC8vdG9kbzogc2F2ZSBjaGFubmVsIFVSTCB0byBzb21lIHNldHRpbmdzIC8gdmFyaWFibGVcbiAgICBjb25zb2xlLmxvZyhcIkxvYWRlZCBjaGFubmVsIFVSTFwiLCBjaGFuZWxVcmwpO1xuXG4gICAgdmFyIGZ1bGxVcmwgPSBjaGFuZWxVcmwgKyBcIiZhbXA7YXV0b3BsYXk9MSZhbXA7Y29udHJvbHM9MCZhbXA7c2hvd2luZm89MCBmcmFtZWJvcmRlcj0wXCI7XG5cbiAgICBjYWxsYmFjayhmdWxsVXJsKTtcblxuICAgIC8vbXkgLSBodHRwczovL3d3dy55b3V0dWJlLmNvbS9wbGF5bGlzdD9saXN0PVBMNDhaR3dDcHdQeUZWaUVMZ3NudlVrblJ6SnlvMmdPaEFcbiAgICAvL2h0dHBzOi8vd3d3LnlvdXR1YmUuY29tL2VtYmVkL3ZpZGVvc2VyaWVzP2xpc3Q9UEw0OFpHd0Nwd1B5RlZpRUxnc252VWtuUnpKeW8yZ09oQVxuICB9KTtcblxufVxuXHJcbi8qIGdsb2JhbCBnYWRnZXRzLCBjb25maWcgKi9cblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5WaWRlbyA9IHt9O1xuXG5SaXNlVmlzaW9uLlZpZGVvID0gKGZ1bmN0aW9uIChnYWRnZXRzKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBfYWRkaXRpb25hbFBhcmFtcztcblxuICB2YXIgX3ByZWZzID0gbnVsbCxcbiAgICBfc3RvcmFnZSA9IG51bGwsXG4gICAgX21lc3NhZ2UgPSBudWxsLFxuICAgIF9mcmFtZUNvbnRyb2xsZXIgPSBudWxsO1xuXG4gIHZhciBfcGxheWJhY2tFcnJvciA9IGZhbHNlLFxuICAgIF9pc1N0b3JhZ2VGaWxlID0gZmFsc2UsXG4gICAgX3ZpZXdlclBhdXNlZCA9IHRydWU7XG5cbiAgdmFyIF9jdXJyZW50RnJhbWUgPSAwO1xuXG4gIHZhciBfc2VwYXJhdG9yID0gXCJcIixcbiAgICBfY3VycmVudEZpbGUgPSBcIlwiO1xuXG4gIHZhciBfcmVmcmVzaER1cmF0aW9uID0gOTAwMDAwLCAgLy8gMTUgbWludXRlc1xuICAgIF9yZWZyZXNoSW50ZXJ2YWxJZCA9IG51bGw7XG5cbiAgdmFyIF9ub0ZpbGVUaW1lciA9IG51bGwsXG4gICAgX25vRmlsZUZsYWcgPSBmYWxzZTtcblxuICB2YXIgX3BsYXlsaXN0Q2hhbmdlVGltZXIgPSBudWxsO1xuXG4gIC8qXG4gICAqICBQcml2YXRlIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIF9jbGVhck5vRmlsZVRpbWVyKCkge1xuICAgIGNsZWFyVGltZW91dChfbm9GaWxlVGltZXIpO1xuICAgIF9ub0ZpbGVUaW1lciA9IG51bGw7XG4gIH1cblxuICBmdW5jdGlvbiBfZG9uZSgpIHtcbiAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNldmVudF9kb25lXCIsIG51bGwsIF9wcmVmcy5nZXRTdHJpbmcoXCJpZFwiKSk7XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIF9yZWFkeSgpIHtcbiAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNldmVudF9yZWFkeVwiLCBudWxsLCBfcHJlZnMuZ2V0U3RyaW5nKFwiaWRcIiksXG4gICAgICB0cnVlLCB0cnVlLCB0cnVlLCB0cnVlLCB0cnVlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9yZWZyZXNoSW50ZXJ2YWwoZHVyYXRpb24pIHtcbiAgICBfcmVmcmVzaEludGVydmFsSWQgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiB2aWRlb1JlZnJlc2goKSB7XG4gICAgICAvLyBzZXQgbmV3IHZhbHVlIG9mIG5vbiByaXNlLXN0b3JhZ2UgdXJsIHdpdGggYSBjYWNoZWJ1c3RlclxuICAgICAgX2N1cnJlbnRGaWxlID0gX2FkZGl0aW9uYWxQYXJhbXMudXJsICsgX3NlcGFyYXRvciArIFwiY2I9XCIgKyBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcblxuICAgICAgLy8gaW4gY2FzZSByZWZyZXNoZWQgZmlsZSBmaXhlcyBhbiBlcnJvciB3aXRoIHByZXZpb3VzIGZpbGUsIGVuc3VyZSBmbGFnIGlzIHJlbW92ZWQgc28gcGxheWJhY2sgaXMgYXR0ZW1wdGVkIGFnYWluXG4gICAgICBfcGxheWJhY2tFcnJvciA9IGZhbHNlO1xuXG4gICAgfSwgZHVyYXRpb24pO1xuICB9XG5cbiAgZnVuY3Rpb24gX3N0YXJ0Tm9GaWxlVGltZXIoKSB7XG4gICAgX2NsZWFyTm9GaWxlVGltZXIoKTtcblxuICAgIF9ub0ZpbGVUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgLy8gbm90aWZ5IFZpZXdlciB3aWRnZXQgaXMgZG9uZVxuICAgICAgX2RvbmUoKTtcbiAgICB9LCA1MDAwKTtcbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gbm9TdG9yYWdlRmlsZSgpIHtcbiAgICBfbm9GaWxlRmxhZyA9IHRydWU7XG4gICAgX2N1cnJlbnRGaWxlID0gXCJcIjtcblxuICAgIF9tZXNzYWdlLnNob3coXCJUaGUgc2VsZWN0ZWQgdmlkZW8gZG9lcyBub3QgZXhpc3QuXCIpO1xuXG4gICAgX2ZyYW1lQ29udHJvbGxlci5yZW1vdmUoX2N1cnJlbnRGcmFtZSwgZnVuY3Rpb24gKCkge1xuICAgICAgLy8gaWYgV2lkZ2V0IGlzIHBsYXlpbmcgcmlnaHQgbm93LCBydW4gdGhlIHRpbWVyXG4gICAgICBpZiAoIV92aWV3ZXJQYXVzZWQpIHtcbiAgICAgICAgX3N0YXJ0Tm9GaWxlVGltZXIoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9uU3RvcmFnZUluaXQodXJsKSB7XG4gICAgX2N1cnJlbnRGaWxlID0gdXJsO1xuXG4gICAgX21lc3NhZ2UuaGlkZSgpO1xuXG4gICAgaWYgKCFfdmlld2VyUGF1c2VkKSB7XG4gICAgICBwbGF5KCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gb25TdG9yYWdlUmVmcmVzaCh1cmwpIHtcbiAgICBfY3VycmVudEZpbGUgPSB1cmw7XG5cbiAgICAvLyBpbiBjYXNlIHJlZnJlc2hlZCBmaWxlIGZpeGVzIGFuIGVycm9yIHdpdGggcHJldmlvdXMgZmlsZSwgZW5zdXJlIGZsYWcgaXMgcmVtb3ZlZCBzbyBwbGF5YmFjayBpcyBhdHRlbXB0ZWQgYWdhaW5cbiAgICBfcGxheWJhY2tFcnJvciA9IGZhbHNlO1xuICB9XG5cbiAgZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgdmFyIGZyYW1lT2JqID0gX2ZyYW1lQ29udHJvbGxlci5nZXRGcmFtZU9iamVjdChfY3VycmVudEZyYW1lKTtcblxuICAgIF92aWV3ZXJQYXVzZWQgPSB0cnVlO1xuXG4gICAgaWYgKF9ub0ZpbGVGbGFnKSB7XG4gICAgICBfY2xlYXJOb0ZpbGVUaW1lcigpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChmcmFtZU9iaikge1xuICAgICAgZnJhbWVPYmoucGF1c2UoKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5KCkge1xuICAvLyAgY29uc29sZS5sb2coXCJQbGF5IGV2ZW50IFwiKTtcbiAgICB2YXIgZnJhbWVPYmogPSBfZnJhbWVDb250cm9sbGVyLmdldEZyYW1lT2JqZWN0KF9jdXJyZW50RnJhbWUpO1xuXG4gICAgX3ZpZXdlclBhdXNlZCA9IGZhbHNlO1xuXG4gICAgaWYgKF9ub0ZpbGVGbGFnKSB7XG4gICAgICBfc3RhcnROb0ZpbGVUaW1lcigpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICghX3BsYXliYWNrRXJyb3IpIHtcbiAgICAgIGlmIChmcmFtZU9iaikge1xuICAgICAgICBmcmFtZU9iai5wbGF5KCk7XG4gICAgICB9IGVsc2Uge1xuXG4gICAgICAgIGlmIChfY3VycmVudEZpbGUgJiYgX2N1cnJlbnRGaWxlICE9PSBcIlwiKSB7XG4gICAgICAgICAgLy8gYWRkIGZyYW1lIGFuZCBjcmVhdGUgdGhlIHBsYXllclxuICAgICAgICAgIF9mcmFtZUNvbnRyb2xsZXIuYWRkKDApO1xuICAgICAgICAgIF9mcmFtZUNvbnRyb2xsZXIuY3JlYXRlRnJhbWVQbGF5ZXIoMCwgX2FkZGl0aW9uYWxQYXJhbXMsIF9jdXJyZW50RmlsZSwgY29uZmlnLlNLSU4sIFwicGxheWVyLmh0bWxcIik7XG4gICAgICAgIH1cblxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBUaGlzIGZsYWcgb25seSBnb3Qgc2V0IHVwb24gYSByZWZyZXNoIG9mIGhpZGRlbiBmcmFtZSBhbmQgdGhlcmUgd2FzIGFuIGVycm9yIGluIHNldHVwIG9yIHZpZGVvXG4gICAgICAvLyBTZW5kIFZpZXdlciBcImRvbmVcIlxuICAgICAgX2RvbmUoKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5ZXJFbmRlZCgpIHtcbiAgICBfZnJhbWVDb250cm9sbGVyLnJlbW92ZShfY3VycmVudEZyYW1lLCBmdW5jdGlvbiAoKSB7XG4gICAgICBfZG9uZSgpO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcGxheWVyUmVhZHkoKSB7XG4gICAgdmFyIGZyYW1lT2JqO1xuXG4gICAgLy8gbm9uLXN0b3JhZ2UsIGNoZWNrIGlmIHJlZnJlc2ggaW50ZXJ2YWwgZXhpc3RzIHlldCwgc3RhcnQgaXQgaWYgbm90XG4gICAgaWYgKCFfaXNTdG9yYWdlRmlsZSAmJiBfcmVmcmVzaEludGVydmFsSWQgPT09IG51bGwpIHtcbiAgICAgIF9yZWZyZXNoSW50ZXJ2YWwoX3JlZnJlc2hEdXJhdGlvbik7XG4gICAgfVxuXG4gICAgaWYgKCFfdmlld2VyUGF1c2VkKSB7XG4gICAgICBmcmFtZU9iaiA9IF9mcmFtZUNvbnRyb2xsZXIuZ2V0RnJhbWVPYmplY3QoX2N1cnJlbnRGcmFtZSk7XG4gICAgICBmcmFtZU9iai5wbGF5KCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gc3RhcnRQbGF5bGlzdENoYW5nZVRpbWVyKCkge1xuICAgIGNsZWFyVGltZW91dChfcGxheWxpc3RDaGFuZ2VUaW1lcik7XG5cbiAgICBfcGxheWxpc3RDaGFuZ2VUaW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiSW50ZXJ2YWwgY2hlY2tcIik7XG5cbiAgICAgIGxvYWRWaWRlb0xpbmtGcm9tWExTdWl0ZShmdW5jdGlvbiAodmlkZW9VcmwpIHtcbiAgICAgIC8vICB2aWRlb1VybCA9IFwiaHR0cHM6Ly93d3cueW91dHViZS5jb20vZW1iZWQvdmlkZW9zZXJpZXM/bGlzdD1QTDQ4Wkd3Q3B3UHlGVmlFTGdzbnZVa25Sekp5bzJnT2hBJmFtcDthdXRvcGxheT0xJmFtcDtjb250cm9scz0wJmFtcDtzaG93aW5mbz0wIGZyYW1lYm9yZGVyPTBcIjtcblxuICAgICAgICBpZiAodmlkZW9VcmwgIT0gX2N1cnJlbnRGaWxlKSB7XG4gICAgICAgICAgX2N1cnJlbnRGaWxlID0gdmlkZW9Vcmw7XG4gICAgICAgICAgdmFyICRtYWluSWZyYW1lID0gJCgnI21haW5JZnJhbWUnKTtcbiAgICAgICAgICAkbWFpbklmcmFtZS5hdHRyKCdzcmMnLCBfY3VycmVudEZpbGUpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgIH0sIDUwMDApO1xuICB9XG5cbiAgZnVuY3Rpb24gc2V0QWRkaXRpb25hbFBhcmFtcyhuYW1lcywgdmFsdWVzKSB7XG4gICAgdmFyIHN0cjtcblxuICAgIGlmIChBcnJheS5pc0FycmF5KG5hbWVzKSAmJiBuYW1lcy5sZW5ndGggPiAwICYmIG5hbWVzWzBdID09PSBcImFkZGl0aW9uYWxQYXJhbXNcIikge1xuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWVzKSAmJiB2YWx1ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBfYWRkaXRpb25hbFBhcmFtcyA9IEpTT04ucGFyc2UodmFsdWVzWzBdKTtcbiAgICAgICAgX3ByZWZzID0gbmV3IGdhZGdldHMuUHJlZnMoKTtcblxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInZpZGVvQ29udGFpbmVyXCIpLnN0eWxlLmhlaWdodCA9IF9wcmVmcy5nZXRJbnQoXCJyc0hcIikgKyBcInB4XCI7XG5cbiAgICAgICAgX2FkZGl0aW9uYWxQYXJhbXMud2lkdGggPSBfcHJlZnMuZ2V0SW50KFwicnNXXCIpO1xuICAgICAgICBfYWRkaXRpb25hbFBhcmFtcy5oZWlnaHQgPSBfcHJlZnMuZ2V0SW50KFwicnNIXCIpO1xuXG4gICAgICAgIF9mcmFtZUNvbnRyb2xsZXIgPSBuZXcgUmlzZVZpc2lvbi5Db21tb24uVmlkZW8uRnJhbWVDb250cm9sbGVyKCk7XG5cbiAgICAgICAgX2lzU3RvcmFnZUZpbGUgPSBmYWxzZTtcblxuICAgICAgICBzdHIgPSBfYWRkaXRpb25hbFBhcmFtcy51cmwuc3BsaXQoXCI/XCIpO1xuXG4gICAgICAgIC8vIHN0b3JlIHRoaXMgZm9yIHRoZSByZWZyZXNoIHRpbWVyXG4gICAgICAgIF9zZXBhcmF0b3IgPSAoc3RyLmxlbmd0aCA9PT0gMSkgPyBcIj9cIiA6IFwiJlwiO1xuICAgICAgICBfY3VycmVudEZpbGUgPSBfYWRkaXRpb25hbFBhcmFtcy51cmw7XG5cbiAgICAgICAgbG9hZFZpZGVvTGlua0Zyb21YTFN1aXRlKGZ1bmN0aW9uICh2aWRlb1VybCkge1xuICAgICAgICAgIF9jdXJyZW50RmlsZSA9IHZpZGVvVXJsO1xuXG4gICAgICAgICAgdmFyICRtYWluSWZyYW1lID0gJCgnI21haW5JZnJhbWUnKTtcbiAgICAgICAgICAkbWFpbklmcmFtZS5hdHRyKCdzcmMnLCBfY3VycmVudEZpbGUpO1xuICAgICAgICAgICRtYWluSWZyYW1lLmF0dHIoJ3dpZHRoJywgX2FkZGl0aW9uYWxQYXJhbXMud2lkdGgpO1xuICAgICAgICAgICRtYWluSWZyYW1lLmF0dHIoJ2hlaWdodCcsIF9hZGRpdGlvbmFsUGFyYW1zLmhlaWdodCk7XG5cbiAgICAgICAgICBzdGFydFBsYXlsaXN0Q2hhbmdlVGltZXIoKTtcblxuICAgICAgICAgIF9yZWFkeSgpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5ZXJFcnJvcihlcnJvcikge1xuICAgIGNvbnNvbGUuZGVidWcoXCJ2aWRlby1mb2xkZXI6OnBsYXllckVycm9yKClcIiwgZXJyb3IpO1xuXG4gICAgLy8gZmxhZyB0aGUgdmlkZW8gaGFzIGFuIGVycm9yXG4gICAgX3BsYXliYWNrRXJyb3IgPSB0cnVlO1xuXG4gICAgLy8gYWN0IGFzIHRob3VnaCB2aWRlbyBoYXMgZW5kZWRcbiAgICBwbGF5ZXJFbmRlZCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICBwYXVzZSgpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBcIm5vU3RvcmFnZUZpbGVcIjogbm9TdG9yYWdlRmlsZSxcbiAgICBcIm9uU3RvcmFnZUluaXRcIjogb25TdG9yYWdlSW5pdCxcbiAgICBcIm9uU3RvcmFnZVJlZnJlc2hcIjogb25TdG9yYWdlUmVmcmVzaCxcbiAgICBcInBhdXNlXCI6IHBhdXNlLFxuICAgIFwicGxheVwiOiBwbGF5LFxuICAgIFwic2V0QWRkaXRpb25hbFBhcmFtc1wiOiBzZXRBZGRpdGlvbmFsUGFyYW1zLFxuICAgIFwicGxheWVyRW5kZWRcIjogcGxheWVyRW5kZWQsXG4gICAgXCJwbGF5ZXJSZWFkeVwiOiBwbGF5ZXJSZWFkeSxcbiAgICBcInBsYXllckVycm9yXCI6IHBsYXllckVycm9yLFxuICAgIFwic3RvcFwiOiBzdG9wXG4gIH07XG5cbn0pKGdhZGdldHMpO1xuXHJcbi8qIGdsb2JhbCBjb25maWcgKi9cblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5WaWRlbyA9IFJpc2VWaXNpb24uVmlkZW8gfHwge307XG5cblJpc2VWaXNpb24uVmlkZW8uU3RvcmFnZSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBfaW5pdGlhbExvYWQgPSB0cnVlO1xuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICB2YXIgc3RvcmFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9TdG9yYWdlXCIpO1xuXG4gICAgaWYgKCFzdG9yYWdlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgc3RvcmFnZS5hZGRFdmVudExpc3RlbmVyKFwicmlzZS1zdG9yYWdlLXJlc3BvbnNlXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIGlmIChlLmRldGFpbCAmJiBlLmRldGFpbC51cmwpIHtcblxuICAgICAgICBpZiAoX2luaXRpYWxMb2FkKSB7XG4gICAgICAgICAgX2luaXRpYWxMb2FkID0gZmFsc2U7XG5cbiAgICAgICAgICBSaXNlVmlzaW9uLlZpZGVvLm9uU3RvcmFnZUluaXQoZS5kZXRhaWwudXJsKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAvLyBjaGVjayBmb3IgXCJjaGFuZ2VkXCIgcHJvcGVydHkgYW5kIGVuc3VyZSBpdCBpcyB0cnVlXG4gICAgICAgICAgaWYgKGUuZGV0YWlsLmhhc093blByb3BlcnR5KFwiY2hhbmdlZFwiKSAmJiBlLmRldGFpbC5jaGFuZ2VkKSB7XG4gICAgICAgICAgICBSaXNlVmlzaW9uLlZpZGVvLm9uU3RvcmFnZVJlZnJlc2goZS5kZXRhaWwudXJsKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHN0b3JhZ2UuYWRkRXZlbnRMaXN0ZW5lcihcInJpc2Utc3RvcmFnZS1uby1maWxlXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgUmlzZVZpc2lvbi5WaWRlby5ub1N0b3JhZ2VGaWxlKCk7XG4gICAgfSk7XG5cbiAgICBzdG9yYWdlLnNldEF0dHJpYnV0ZShcImZvbGRlclwiLCBkYXRhLnN0b3JhZ2UuZm9sZGVyKTtcbiAgICBzdG9yYWdlLnNldEF0dHJpYnV0ZShcImZpbGVOYW1lXCIsIGRhdGEuc3RvcmFnZS5maWxlTmFtZSk7XG4gICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJjb21wYW55SWRcIiwgZGF0YS5zdG9yYWdlLmNvbXBhbnlJZCk7XG4gICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJlbnZcIiwgY29uZmlnLlNUT1JBR0VfRU5WKTtcbiAgICBzdG9yYWdlLmdvKCk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIFwiaW5pdFwiOiBpbml0XG4gIH07XG59O1xuXHJcbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcclxuUmlzZVZpc2lvbi5Db21tb24gPSBSaXNlVmlzaW9uLkNvbW1vbiB8fCB7fTtcclxuXHJcblJpc2VWaXNpb24uQ29tbW9uLlZpZGVvID0gUmlzZVZpc2lvbi5Db21tb24uVmlkZW8gfHwge307XHJcblxyXG5SaXNlVmlzaW9uLkNvbW1vbi5WaWRlby5GcmFtZUNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gIHZhciBQUkVGSVggPSBcImlmX1wiO1xyXG5cclxuICBmdW5jdGlvbiBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFBSRUZJWCArIGluZGV4KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGdldEZyYW1lT2JqZWN0KGluZGV4KSB7XHJcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCksXHJcbiAgICAgIGlmcmFtZTtcclxuXHJcbiAgICBpZnJhbWUgPSBmcmFtZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiaWZyYW1lXCIpO1xyXG5cclxuICAgIGlmIChpZnJhbWUpIHtcclxuICAgICAgcmV0dXJuIChpZnJhbWUuY29udGVudFdpbmRvdykgPyBpZnJhbWUuY29udGVudFdpbmRvdyA6XHJcbiAgICAgICAgKGlmcmFtZS5jb250ZW50RG9jdW1lbnQuZG9jdW1lbnQpID8gaWZyYW1lLmNvbnRlbnREb2N1bWVudC5kb2N1bWVudCA6IGlmcmFtZS5jb250ZW50RG9jdW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBfY2xlYXIoaW5kZXgpIHtcclxuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGdldEZyYW1lQ29udGFpbmVyKGluZGV4KSxcclxuICAgICAgZnJhbWVPYmogPSBnZXRGcmFtZU9iamVjdChpbmRleCksXHJcbiAgICAgIGlmcmFtZTtcclxuXHJcbiAgICBpZiAoZnJhbWVPYmopIHtcclxuICAgICAgaWZyYW1lID0gZnJhbWVDb250YWluZXIucXVlcnlTZWxlY3RvcihcImlmcmFtZVwiKTtcclxuICAgICAgZnJhbWVPYmoucmVtb3ZlKCk7XHJcbiAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgXCJhYm91dDpibGFua1wiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGFkZChpbmRleCkge1xyXG4gICAgdmFyIGZyYW1lQ29udGFpbmVyID0gZ2V0RnJhbWVDb250YWluZXIoaW5kZXgpLFxyXG4gICAgICBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaWZyYW1lXCIpO1xyXG5cclxuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJhbGxvd1RyYW5zcGFyZW5jeVwiLCB0cnVlKTtcclxuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJmcmFtZWJvcmRlclwiLCBcIjBcIik7XHJcbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKFwic2Nyb2xsaW5nXCIsIFwibm9cIik7XHJcblxyXG4gICAgZnJhbWVDb250YWluZXIuYXBwZW5kQ2hpbGQoaWZyYW1lKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNyZWF0ZUZyYW1lUGxheWVyKGluZGV4LCBwYXJhbXMsIGZpbGVzLCBza2luLCBzcmMpIHtcclxuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGdldEZyYW1lQ29udGFpbmVyKGluZGV4KSxcclxuICAgICAgZnJhbWVPYmogPSBnZXRGcmFtZU9iamVjdChpbmRleCksXHJcbiAgICAgIGlmcmFtZTtcclxuXHJcbiAgICBpZiAoZnJhbWVPYmopIHtcclxuICAgICAgaWZyYW1lID0gZnJhbWVDb250YWluZXIucXVlcnlTZWxlY3RvcihcImlmcmFtZVwiKTtcclxuXHJcbiAgICAgIGlmcmFtZS5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWZyYW1lLm9ubG9hZCA9IG51bGw7XHJcblxyXG4gICAgICAgIC8vIGluaXRpYWxpemUgYW5kIGxvYWQgdGhlIHBsYXllciBpbnNpZGUgdGhlIGlmcmFtZVxyXG4gICAgICAgIGZyYW1lT2JqLmluaXQocGFyYW1zLCBmaWxlcywgc2tpbik7XHJcbiAgICAgICAgZnJhbWVPYmoubG9hZCgpO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZShcInNyY1wiLCBzcmMpO1xyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGhpZGUoaW5kZXgpIHtcclxuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGdldEZyYW1lQ29udGFpbmVyKGluZGV4KTtcclxuXHJcbiAgICBmcmFtZUNvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gXCJoaWRkZW5cIjtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHJlbW92ZShpbmRleCwgY2FsbGJhY2spIHtcclxuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFBSRUZJWCArIGluZGV4KTtcclxuXHJcbiAgICBfY2xlYXIoaW5kZXgpO1xyXG5cclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAvLyByZW1vdmUgdGhlIGlmcmFtZSBieSBjbGVhcmluZyBhbGwgZWxlbWVudHMgaW5zaWRlIGRpdiBjb250YWluZXJcclxuICAgICAgd2hpbGUgKGZyYW1lQ29udGFpbmVyLmZpcnN0Q2hpbGQpIHtcclxuICAgICAgICBmcmFtZUNvbnRhaW5lci5yZW1vdmVDaGlsZChmcmFtZUNvbnRhaW5lci5maXJzdENoaWxkKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKGNhbGxiYWNrICYmIHR5cGVvZiBjYWxsYmFjayA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgfVxyXG4gICAgfSwgMjAwKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHNob3coaW5kZXgpIHtcclxuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGdldEZyYW1lQ29udGFpbmVyKGluZGV4KTtcclxuXHJcbiAgICBmcmFtZUNvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gXCJ2aXNpYmxlXCI7XHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgYWRkOiBhZGQsXHJcbiAgICBjcmVhdGVGcmFtZVBsYXllcjogY3JlYXRlRnJhbWVQbGF5ZXIsXHJcbiAgICBnZXRGcmFtZUNvbnRhaW5lcjogZ2V0RnJhbWVDb250YWluZXIsXHJcbiAgICBnZXRGcmFtZU9iamVjdDogZ2V0RnJhbWVPYmplY3QsXHJcbiAgICBoaWRlOiBoaWRlLFxyXG4gICAgcmVtb3ZlOiByZW1vdmUsXHJcbiAgICBzaG93OiBzaG93XHJcbiAgfTtcclxufTtcclxuXHJcbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcclxuUmlzZVZpc2lvbi5Db21tb24gPSBSaXNlVmlzaW9uLkNvbW1vbiB8fCB7fTtcclxuXHJcblJpc2VWaXNpb24uQ29tbW9uLk1lc3NhZ2UgPSBmdW5jdGlvbiAobWFpbkNvbnRhaW5lciwgbWVzc2FnZUNvbnRhaW5lcikge1xyXG4gIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICB2YXIgX2FjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICBmdW5jdGlvbiBfaW5pdCgpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIG1lc3NhZ2VDb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gbWFpbkNvbnRhaW5lci5zdHlsZS5oZWlnaHQ7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybihcIkNhbid0IGluaXRpYWxpemUgTWVzc2FnZSAtIFwiLCBlLm1lc3NhZ2UpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLypcclxuICAgKiAgUHVibGljIE1ldGhvZHNcclxuICAgKi9cclxuICBmdW5jdGlvbiBoaWRlKCkge1xyXG4gICAgaWYgKF9hY3RpdmUpIHtcclxuICAgICAgLy8gY2xlYXIgY29udGVudCBvZiBtZXNzYWdlIGNvbnRhaW5lclxyXG4gICAgICB3aGlsZSAobWVzc2FnZUNvbnRhaW5lci5maXJzdENoaWxkKSB7XHJcbiAgICAgICAgbWVzc2FnZUNvbnRhaW5lci5yZW1vdmVDaGlsZChtZXNzYWdlQ29udGFpbmVyLmZpcnN0Q2hpbGQpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBoaWRlIG1lc3NhZ2UgY29udGFpbmVyXHJcbiAgICAgIG1lc3NhZ2VDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG5cclxuICAgICAgLy8gc2hvdyBtYWluIGNvbnRhaW5lclxyXG4gICAgICBtYWluQ29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHkgPSBcInZpc2libGVcIjtcclxuXHJcbiAgICAgIF9hY3RpdmUgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHNob3cobWVzc2FnZSkge1xyXG4gICAgdmFyIGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLFxyXG4gICAgICBwO1xyXG5cclxuICAgIGlmICghX2FjdGl2ZSkge1xyXG4gICAgICAvLyBoaWRlIG1haW4gY29udGFpbmVyXHJcbiAgICAgIG1haW5Db250YWluZXIuc3R5bGUudmlzaWJpbGl0eSA9IFwiaGlkZGVuXCI7XHJcblxyXG4gICAgICBtZXNzYWdlQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcblxyXG4gICAgICAvLyBjcmVhdGUgbWVzc2FnZSBlbGVtZW50XHJcbiAgICAgIHAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcclxuICAgICAgcC5pbm5lckhUTUwgPSBtZXNzYWdlO1xyXG4gICAgICBwLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwibWVzc2FnZVwiKTtcclxuICAgICAgcC5zdHlsZS5saW5lSGVpZ2h0ID0gbWVzc2FnZUNvbnRhaW5lci5zdHlsZS5oZWlnaHQ7XHJcblxyXG4gICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChwKTtcclxuICAgICAgbWVzc2FnZUNvbnRhaW5lci5hcHBlbmRDaGlsZChmcmFnbWVudCk7XHJcblxyXG4gICAgICBfYWN0aXZlID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIG1lc3NhZ2UgYWxyZWFkeSBiZWluZyBzaG93biwgdXBkYXRlIG1lc3NhZ2UgdGV4dFxyXG4gICAgICBwID0gbWVzc2FnZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLm1lc3NhZ2VcIik7XHJcbiAgICAgIHAuaW5uZXJIVE1MID0gbWVzc2FnZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9pbml0KCk7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBcImhpZGVcIjogaGlkZSxcclxuICAgIFwic2hvd1wiOiBzaG93XHJcbiAgfTtcclxufTtcclxuXHJcbi8qIGdsb2JhbCBnYWRnZXRzLCBSaXNlVmlzaW9uICovXG5cbihmdW5jdGlvbiAod2luZG93LCBnYWRnZXRzKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBwcmVmcyA9IG5ldyBnYWRnZXRzLlByZWZzKCksXG4gICAgaWQgPSBwcmVmcy5nZXRTdHJpbmcoXCJpZFwiKTtcblxuICAvLyBEaXNhYmxlIGNvbnRleHQgbWVudSAocmlnaHQgY2xpY2sgbWVudSlcbiAgd2luZG93Lm9uY29udGV4dG1lbnUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgUmlzZVZpc2lvbi5WaWRlby5wbGF5KCk7XG4gIH1cblxuICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICBSaXNlVmlzaW9uLlZpZGVvLnBhdXNlKCk7XG4gIH1cblxuICBmdW5jdGlvbiBzdG9wKCkge1xuICAgIFJpc2VWaXNpb24uVmlkZW8uc3RvcCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gcG9seW1lclJlYWR5KCkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwiV2ViQ29tcG9uZW50c1JlYWR5XCIsIHBvbHltZXJSZWFkeSk7XG5cbiAgICBpZiAoaWQgJiYgaWQgIT09IFwiXCIpIHtcbiAgICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNjbWRfcGxheV9cIiArIGlkLCBwbGF5KTtcbiAgICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNjbWRfcGF1c2VfXCIgKyBpZCwgcGF1c2UpO1xuICAgICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc2NtZF9zdG9wX1wiICsgaWQsIHN0b3ApO1xuXG4gICAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzcGFyYW1fc2V0X1wiICsgaWQsIFJpc2VWaXNpb24uVmlkZW8uc2V0QWRkaXRpb25hbFBhcmFtcyk7XG4gICAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNwYXJhbV9nZXRcIiwgbnVsbCwgaWQsIFtcImFkZGl0aW9uYWxQYXJhbXNcIl0pO1xuICAgIH1cbiAgfVxuXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiV2ViQ29tcG9uZW50c1JlYWR5XCIsIHBvbHltZXJSZWFkeSk7XG5cbn0pKHdpbmRvdywgZ2FkZ2V0cyk7XG5cblxuXHJcbi8qIGpzaGludCBpZ25vcmU6c3RhcnQgKi9cbnZhciBfZ2FxID0gX2dhcSB8fCBbXTtcblxuX2dhcS5wdXNoKFsnX3NldEFjY291bnQnLCAnVUEtNTcwOTIxNTktMiddKTtcbl9nYXEucHVzaChbJ190cmFja1BhZ2V2aWV3J10pO1xuXG4oZnVuY3Rpb24oKSB7XG4gIHZhciBnYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOyBnYS50eXBlID0gJ3RleHQvamF2YXNjcmlwdCc7IGdhLmFzeW5jID0gdHJ1ZTtcbiAgZ2Euc3JjID0gKCdodHRwczonID09IGRvY3VtZW50LmxvY2F0aW9uLnByb3RvY29sID8gJ2h0dHBzOi8vc3NsJyA6ICdodHRwOi8vd3d3JykgKyAnLmdvb2dsZS1hbmFseXRpY3MuY29tL2dhLmpzJztcbiAgdmFyIHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2NyaXB0JylbMF07IHMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZ2EsIHMpO1xufSkoKTtcbi8qIGpzaGludCBpZ25vcmU6ZW5kICovXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
