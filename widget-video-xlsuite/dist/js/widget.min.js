if("undefined"==typeof config){var config={SKIN:"skin/RVSkin.xml",STORAGE_ENV:"prod"};"undefined"!=typeof angular&&angular.module("risevision.common.i18n.config",[]).constant("LOCALES_PREFIX","locales/translation_").constant("LOCALES_SUFIX",".json")}var RiseVision=RiseVision||{};RiseVision.Video={},RiseVision.Video=function(e){"use strict";function t(){clearTimeout(F),F=null}function i(){e.rpc.call("","rsevent_done",null,v.getString("id"))}function n(){e.rpc.call("","rsevent_ready",null,v.getString("id"),!0,!0,!0,!0,!0)}function o(e){I=setInterval(function(){_=p.url+E+"cb="+(new Date).getTime(),C=!1},e)}function r(){t(),F=setTimeout(function(){i()},5e3)}function s(){P=!0,_="",h.show("The selected video does not exist."),R.remove(S,function(){w||r()})}function a(e){_=e,h.hide(),w||d()}function l(e){_=e,C=!1}function c(){var e=R.getFrameObject(S);return w=!0,P?(t(),void 0):(e&&e.pause(),void 0)}function d(){var e=R.getFrameObject(S);return w=!1,P?(r(),void 0):(C?i():e?e.play():_&&""!==_&&(R.add(0),R.createFramePlayer(0,p,_,config.SKIN,"player.html")),void 0)}function u(){R.remove(S,function(){i()})}function m(){var e;b||null!==I||o(A),w||(e=R.getFrameObject(S),e.play())}function g(t,i){var o;Array.isArray(t)&&t.length>0&&"additionalParams"===t[0]&&Array.isArray(i)&&i.length>0&&(p=JSON.parse(i[0]),v=new e.Prefs,document.getElementById("videoContainer").style.height=v.getInt("rsH")+"px",p.width=v.getInt("rsW"),p.height=v.getInt("rsH"),h=new RiseVision.Common.Message(document.getElementById("videoContainer"),document.getElementById("messageContainer")),h.show("Please wait while your video is downloaded."),R=new RiseVision.Common.Video.FrameController,b=0!==Object.keys(p.storage).length,b?(V=new RiseVision.Video.Storage(p),V.init()):(o=p.url.split("?"),E=1===o.length?"?":"&",_=p.url),n())}function f(e){console.debug("video-folder::playerError()",e),C=!0,u()}function y(){c()}var p,v=null,V=null,h=null,R=null,C=!1,b=!1,w=!0,S=0,E="",_="",A=9e5,I=null,F=null,P=!1;return{noStorageFile:s,onStorageInit:a,onStorageRefresh:l,pause:c,play:d,setAdditionalParams:g,playerEnded:u,playerReady:m,playerError:f,stop:y}}(gadgets);var RiseVision=RiseVision||{};RiseVision.Video=RiseVision.Video||{},RiseVision.Video.Storage=function(e){"use strict";function t(){var t=document.getElementById("videoStorage");t&&(t.addEventListener("rise-storage-response",function(e){e.detail&&e.detail.url&&(i?(i=!1,RiseVision.Video.onStorageInit(e.detail.url)):e.detail.hasOwnProperty("changed")&&e.detail.changed&&RiseVision.Video.onStorageRefresh(e.detail.url))}),t.addEventListener("rise-storage-no-file",function(){RiseVision.Video.noStorageFile()}),t.setAttribute("folder",e.storage.folder),t.setAttribute("fileName",e.storage.fileName),t.setAttribute("companyId",e.storage.companyId),t.setAttribute("env",config.STORAGE_ENV),t.go())}var i=!0;return{init:t}};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Video=RiseVision.Common.Video||{},RiseVision.Common.Video.FrameController=function(){"use strict";function e(e){return document.getElementById(l+e)}function t(t){var i,n=e(t);return i=n.querySelector("iframe"),i?i.contentWindow?i.contentWindow:i.contentDocument.document?i.contentDocument.document:i.contentDocument:null}function i(i){var n,o=e(i),r=t(i);r&&(n=o.querySelector("iframe"),r.remove(),n.setAttribute("src","about:blank"))}function n(t){var i=e(t),n=document.createElement("iframe");n.setAttribute("allowTransparency",!0),n.setAttribute("frameborder","0"),n.setAttribute("scrolling","no"),i.appendChild(n)}function o(i,n,o,r,s){var a,l=e(i),c=t(i);c&&(a=l.querySelector("iframe"),a.onload=function(){a.onload=null,c.init(n,o,r),c.load()},a.setAttribute("src",s))}function r(t){var i=e(t);i.style.visibility="hidden"}function s(e,t){var n=document.getElementById(l+e);i(e),setTimeout(function(){for(;n.firstChild;)n.removeChild(n.firstChild);t&&"function"==typeof t&&t()},200)}function a(t){var i=e(t);i.style.visibility="visible"}var l="if_";return{add:n,createFramePlayer:o,getFrameContainer:e,getFrameObject:t,hide:r,remove:s,show:a}};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Message=function(e,t){"use strict";function i(){try{t.style.height=e.style.height}catch(i){console.warn("Can't initialize Message - ",i.message)}}function n(){if(r){for(;t.firstChild;)t.removeChild(t.firstChild);t.style.display="none",e.style.visibility="visible",r=!1}}function o(i){var n,o=document.createDocumentFragment();r?(n=t.querySelector(".message"),n.innerHTML=i):(e.style.visibility="hidden",t.style.display="block",n=document.createElement("p"),n.innerHTML=i,n.setAttribute("class","message"),n.style.lineHeight=t.style.height,o.appendChild(n),t.appendChild(o),r=!0)}var r=!1;return i(),{hide:n,show:o}},function(e,t){"use strict";function i(){RiseVision.Video.play()}function n(){RiseVision.Video.pause()}function o(){RiseVision.Video.stop()}function r(){e.removeEventListener("WebComponentsReady",r),a&&""!==a&&(t.rpc.register("rscmd_play_"+a,i),t.rpc.register("rscmd_pause_"+a,n),t.rpc.register("rscmd_stop_"+a,o),t.rpc.register("rsparam_set_"+a,RiseVision.Video.setAdditionalParams),t.rpc.call("","rsparam_get",null,a,["additionalParams"]))}var s=new t.Prefs,a=s.getString("id");e.oncontextmenu=function(){return!1},e.addEventListener("WebComponentsReady",r)}(window,gadgets);var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57092159-2"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3dpZGdldC5taW4uanMiXSwibmFtZXMiOlsiY29uZmlnIiwiU0tJTiIsIlNUT1JBR0VfRU5WIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbnN0YW50IiwiUmlzZVZpc2lvbiIsIlZpZGVvIiwiZ2FkZ2V0cyIsIl9jbGVhck5vRmlsZVRpbWVyIiwiY2xlYXJUaW1lb3V0IiwiX25vRmlsZVRpbWVyIiwiX2RvbmUiLCJycGMiLCJjYWxsIiwiX3ByZWZzIiwiZ2V0U3RyaW5nIiwiX3JlYWR5IiwiX3JlZnJlc2hJbnRlcnZhbCIsImR1cmF0aW9uIiwiX3JlZnJlc2hJbnRlcnZhbElkIiwic2V0SW50ZXJ2YWwiLCJfY3VycmVudEZpbGUiLCJfYWRkaXRpb25hbFBhcmFtcyIsInVybCIsIl9zZXBhcmF0b3IiLCJEYXRlIiwiZ2V0VGltZSIsIl9wbGF5YmFja0Vycm9yIiwiX3N0YXJ0Tm9GaWxlVGltZXIiLCJzZXRUaW1lb3V0Iiwibm9TdG9yYWdlRmlsZSIsIl9ub0ZpbGVGbGFnIiwiX21lc3NhZ2UiLCJzaG93IiwiX2ZyYW1lQ29udHJvbGxlciIsInJlbW92ZSIsIl9jdXJyZW50RnJhbWUiLCJfdmlld2VyUGF1c2VkIiwib25TdG9yYWdlSW5pdCIsImhpZGUiLCJwbGF5Iiwib25TdG9yYWdlUmVmcmVzaCIsInBhdXNlIiwiZnJhbWVPYmoiLCJnZXRGcmFtZU9iamVjdCIsImFkZCIsImNyZWF0ZUZyYW1lUGxheWVyIiwicGxheWVyRW5kZWQiLCJwbGF5ZXJSZWFkeSIsIl9pc1N0b3JhZ2VGaWxlIiwiX3JlZnJlc2hEdXJhdGlvbiIsInNldEFkZGl0aW9uYWxQYXJhbXMiLCJuYW1lcyIsInZhbHVlcyIsInN0ciIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsIkpTT04iLCJwYXJzZSIsIlByZWZzIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInN0eWxlIiwiaGVpZ2h0IiwiZ2V0SW50Iiwid2lkdGgiLCJDb21tb24iLCJNZXNzYWdlIiwiRnJhbWVDb250cm9sbGVyIiwiT2JqZWN0Iiwia2V5cyIsInN0b3JhZ2UiLCJfc3RvcmFnZSIsIlN0b3JhZ2UiLCJpbml0Iiwic3BsaXQiLCJwbGF5ZXJFcnJvciIsImVycm9yIiwiY29uc29sZSIsImRlYnVnIiwic3RvcCIsImRhdGEiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsImRldGFpbCIsIl9pbml0aWFsTG9hZCIsImhhc093blByb3BlcnR5IiwiY2hhbmdlZCIsInNldEF0dHJpYnV0ZSIsImZvbGRlciIsImZpbGVOYW1lIiwiY29tcGFueUlkIiwiZ28iLCJnZXRGcmFtZUNvbnRhaW5lciIsImluZGV4IiwiUFJFRklYIiwiaWZyYW1lIiwiZnJhbWVDb250YWluZXIiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudFdpbmRvdyIsImNvbnRlbnREb2N1bWVudCIsIl9jbGVhciIsImNyZWF0ZUVsZW1lbnQiLCJhcHBlbmRDaGlsZCIsInBhcmFtcyIsImZpbGVzIiwic2tpbiIsInNyYyIsIm9ubG9hZCIsImxvYWQiLCJ2aXNpYmlsaXR5IiwiY2FsbGJhY2siLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJtYWluQ29udGFpbmVyIiwibWVzc2FnZUNvbnRhaW5lciIsIl9pbml0Iiwid2FybiIsIm1lc3NhZ2UiLCJfYWN0aXZlIiwiZGlzcGxheSIsInAiLCJmcmFnbWVudCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJpbm5lckhUTUwiLCJsaW5lSGVpZ2h0Iiwid2luZG93IiwicG9seW1lclJlYWR5IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImlkIiwicmVnaXN0ZXIiLCJwcmVmcyIsIm9uY29udGV4dG1lbnUiLCJfZ2FxIiwicHVzaCIsImdhIiwidHlwZSIsImFzeW5jIiwibG9jYXRpb24iLCJwcm90b2NvbCIsInMiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInBhcmVudE5vZGUiLCJpbnNlcnRCZWZvcmUiXSwibWFwcGluZ3MiOiJBQUVBLEdBQXNCLG1CQUFYQSxRQUF3QixDQUNqQyxHQUFJQSxTQUNGQyxLQUFN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LG1CQUVYLFdBQ0UsR0FBSUMsR0FBSzNFLFNBQVMwQyxjQUFjLFNBQVdpQyxHQUFHQyxLQUFPLGtCQUFtQkQsRUFBR0UsT0FBUSxFQUNuRkYsRUFBRzVCLEtBQU8sVUFBWS9DLFNBQVM4RSxTQUFTQyxTQUFXLGNBQWdCLGNBQWdCLDZCQUNuRixJQUFJQyxHQUFJaEYsU0FBU2lGLHFCQUFxQixVQUFVLEVBQUlELEdBQUVFLFdBQVdDLGFBQWFSLEVBQUlLIiwiZmlsZSI6ImpzL3dpZGdldC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBnbG9iYWwgY29uZmlnOiB0cnVlICovXG4vKiBleHBvcnRlZCBjb25maWcgKi9cbmlmICh0eXBlb2YgY29uZmlnID09PSBcInVuZGVmaW5lZFwiKSB7XG4gIHZhciBjb25maWcgPSB7XG4gICAgU0tJTjogXCJza2luL1JWU2tpbi54bWxcIixcbiAgICBTVE9SQUdFX0VOVjogXCJwcm9kXCJcbiAgfTtcblxuICBpZiAodHlwZW9mIGFuZ3VsYXIgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICBhbmd1bGFyLm1vZHVsZShcInJpc2V2aXNpb24uY29tbW9uLmkxOG4uY29uZmlnXCIsIFtdKVxuICAgICAgLmNvbnN0YW50KFwiTE9DQUxFU19QUkVGSVhcIiwgXCJsb2NhbGVzL3RyYW5zbGF0aW9uX1wiKVxuICAgICAgLmNvbnN0YW50KFwiTE9DQUxFU19TVUZJWFwiLCBcIi5qc29uXCIpO1xuICB9XG59XG5cclxuLyogZ2xvYmFsIGdhZGdldHMsIGNvbmZpZyAqL1xuXG52YXIgUmlzZVZpc2lvbiA9IFJpc2VWaXNpb24gfHwge307XG5SaXNlVmlzaW9uLlZpZGVvID0ge307XG5cblJpc2VWaXNpb24uVmlkZW8gPSAoZnVuY3Rpb24gKGdhZGdldHMpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIF9hZGRpdGlvbmFsUGFyYW1zO1xuXG4gIHZhciBfcHJlZnMgPSBudWxsLFxuICAgIF9zdG9yYWdlID0gbnVsbCxcbiAgICBfbWVzc2FnZSA9IG51bGwsXG4gICAgX2ZyYW1lQ29udHJvbGxlciA9IG51bGw7XG5cbiAgdmFyIF9wbGF5YmFja0Vycm9yID0gZmFsc2UsXG4gICAgX2lzU3RvcmFnZUZpbGUgPSBmYWxzZSxcbiAgICBfdmlld2VyUGF1c2VkID0gdHJ1ZTtcblxuICB2YXIgX2N1cnJlbnRGcmFtZSA9IDA7XG5cbiAgdmFyIF9zZXBhcmF0b3IgPSBcIlwiLFxuICAgIF9jdXJyZW50RmlsZSA9IFwiXCI7XG5cbiAgdmFyIF9yZWZyZXNoRHVyYXRpb24gPSA5MDAwMDAsICAvLyAxNSBtaW51dGVzXG4gICAgX3JlZnJlc2hJbnRlcnZhbElkID0gbnVsbDtcblxuICB2YXIgX25vRmlsZVRpbWVyID0gbnVsbCxcbiAgICBfbm9GaWxlRmxhZyA9IGZhbHNlO1xuXG4gIC8qXG4gICAqICBQcml2YXRlIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIF9jbGVhck5vRmlsZVRpbWVyKCkge1xuICAgIGNsZWFyVGltZW91dChfbm9GaWxlVGltZXIpO1xuICAgIF9ub0ZpbGVUaW1lciA9IG51bGw7XG4gIH1cblxuICBmdW5jdGlvbiBfZG9uZSgpIHtcbiAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNldmVudF9kb25lXCIsIG51bGwsIF9wcmVmcy5nZXRTdHJpbmcoXCJpZFwiKSk7XG5cbiAgfVxuXG4gIGZ1bmN0aW9uIF9yZWFkeSgpIHtcbiAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNldmVudF9yZWFkeVwiLCBudWxsLCBfcHJlZnMuZ2V0U3RyaW5nKFwiaWRcIiksXG4gICAgICB0cnVlLCB0cnVlLCB0cnVlLCB0cnVlLCB0cnVlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9yZWZyZXNoSW50ZXJ2YWwoZHVyYXRpb24pIHtcbiAgICBfcmVmcmVzaEludGVydmFsSWQgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiB2aWRlb1JlZnJlc2goKSB7XG4gICAgICAvLyBzZXQgbmV3IHZhbHVlIG9mIG5vbiByaXNlLXN0b3JhZ2UgdXJsIHdpdGggYSBjYWNoZWJ1c3RlclxuICAgICAgX2N1cnJlbnRGaWxlID0gX2FkZGl0aW9uYWxQYXJhbXMudXJsICsgX3NlcGFyYXRvciArIFwiY2I9XCIgKyBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcblxuICAgICAgLy8gaW4gY2FzZSByZWZyZXNoZWQgZmlsZSBmaXhlcyBhbiBlcnJvciB3aXRoIHByZXZpb3VzIGZpbGUsIGVuc3VyZSBmbGFnIGlzIHJlbW92ZWQgc28gcGxheWJhY2sgaXMgYXR0ZW1wdGVkIGFnYWluXG4gICAgICBfcGxheWJhY2tFcnJvciA9IGZhbHNlO1xuXG4gICAgfSwgZHVyYXRpb24pO1xuICB9XG5cbiAgZnVuY3Rpb24gX3N0YXJ0Tm9GaWxlVGltZXIoKSB7XG4gICAgX2NsZWFyTm9GaWxlVGltZXIoKTtcblxuICAgIF9ub0ZpbGVUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgLy8gbm90aWZ5IFZpZXdlciB3aWRnZXQgaXMgZG9uZVxuICAgICAgX2RvbmUoKTtcbiAgICB9LCA1MDAwKTtcbiAgfVxuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gbm9TdG9yYWdlRmlsZSgpIHtcbiAgICBfbm9GaWxlRmxhZyA9IHRydWU7XG4gICAgX2N1cnJlbnRGaWxlID0gXCJcIjtcblxuICAgIF9tZXNzYWdlLnNob3coXCJUaGUgc2VsZWN0ZWQgdmlkZW8gZG9lcyBub3QgZXhpc3QuXCIpO1xuXG4gICAgX2ZyYW1lQ29udHJvbGxlci5yZW1vdmUoX2N1cnJlbnRGcmFtZSwgZnVuY3Rpb24gKCkge1xuICAgICAgLy8gaWYgV2lkZ2V0IGlzIHBsYXlpbmcgcmlnaHQgbm93LCBydW4gdGhlIHRpbWVyXG4gICAgICBpZiAoIV92aWV3ZXJQYXVzZWQpIHtcbiAgICAgICAgX3N0YXJ0Tm9GaWxlVGltZXIoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9uU3RvcmFnZUluaXQodXJsKSB7XG4gICAgX2N1cnJlbnRGaWxlID0gdXJsO1xuXG4gICAgX21lc3NhZ2UuaGlkZSgpO1xuXG4gICAgaWYgKCFfdmlld2VyUGF1c2VkKSB7XG4gICAgICBwbGF5KCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gb25TdG9yYWdlUmVmcmVzaCh1cmwpIHtcbiAgICBfY3VycmVudEZpbGUgPSB1cmw7XG5cbiAgICAvLyBpbiBjYXNlIHJlZnJlc2hlZCBmaWxlIGZpeGVzIGFuIGVycm9yIHdpdGggcHJldmlvdXMgZmlsZSwgZW5zdXJlIGZsYWcgaXMgcmVtb3ZlZCBzbyBwbGF5YmFjayBpcyBhdHRlbXB0ZWQgYWdhaW5cbiAgICBfcGxheWJhY2tFcnJvciA9IGZhbHNlO1xuICB9XG5cbiAgZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgdmFyIGZyYW1lT2JqID0gX2ZyYW1lQ29udHJvbGxlci5nZXRGcmFtZU9iamVjdChfY3VycmVudEZyYW1lKTtcblxuICAgIF92aWV3ZXJQYXVzZWQgPSB0cnVlO1xuXG4gICAgaWYgKF9ub0ZpbGVGbGFnKSB7XG4gICAgICBfY2xlYXJOb0ZpbGVUaW1lcigpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChmcmFtZU9iaikge1xuICAgICAgZnJhbWVPYmoucGF1c2UoKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5KCkge1xuICAgIHZhciBmcmFtZU9iaiA9IF9mcmFtZUNvbnRyb2xsZXIuZ2V0RnJhbWVPYmplY3QoX2N1cnJlbnRGcmFtZSk7XG5cbiAgICBfdmlld2VyUGF1c2VkID0gZmFsc2U7XG5cbiAgICBpZiAoX25vRmlsZUZsYWcpIHtcbiAgICAgIF9zdGFydE5vRmlsZVRpbWVyKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKCFfcGxheWJhY2tFcnJvcikge1xuICAgICAgaWYgKGZyYW1lT2JqKSB7XG4gICAgICAgIGZyYW1lT2JqLnBsYXkoKTtcbiAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgaWYgKF9jdXJyZW50RmlsZSAmJiBfY3VycmVudEZpbGUgIT09IFwiXCIpIHtcbiAgICAgICAgICAvLyBhZGQgZnJhbWUgYW5kIGNyZWF0ZSB0aGUgcGxheWVyXG4gICAgICAgICAgX2ZyYW1lQ29udHJvbGxlci5hZGQoMCk7XG4gICAgICAgICAgX2ZyYW1lQ29udHJvbGxlci5jcmVhdGVGcmFtZVBsYXllcigwLCBfYWRkaXRpb25hbFBhcmFtcywgX2N1cnJlbnRGaWxlLCBjb25maWcuU0tJTiwgXCJwbGF5ZXIuaHRtbFwiKTtcbiAgICAgICAgfVxuXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFRoaXMgZmxhZyBvbmx5IGdvdCBzZXQgdXBvbiBhIHJlZnJlc2ggb2YgaGlkZGVuIGZyYW1lIGFuZCB0aGVyZSB3YXMgYW4gZXJyb3IgaW4gc2V0dXAgb3IgdmlkZW9cbiAgICAgIC8vIFNlbmQgVmlld2VyIFwiZG9uZVwiXG4gICAgICBfZG9uZSgpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYXllckVuZGVkKCkge1xuICAgIF9mcmFtZUNvbnRyb2xsZXIucmVtb3ZlKF9jdXJyZW50RnJhbWUsIGZ1bmN0aW9uICgpIHtcbiAgICAgIF9kb25lKCk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5ZXJSZWFkeSgpIHtcbiAgICB2YXIgZnJhbWVPYmo7XG5cbiAgICAvLyBub24tc3RvcmFnZSwgY2hlY2sgaWYgcmVmcmVzaCBpbnRlcnZhbCBleGlzdHMgeWV0LCBzdGFydCBpdCBpZiBub3RcbiAgICBpZiAoIV9pc1N0b3JhZ2VGaWxlICYmIF9yZWZyZXNoSW50ZXJ2YWxJZCA9PT0gbnVsbCkge1xuICAgICAgX3JlZnJlc2hJbnRlcnZhbChfcmVmcmVzaER1cmF0aW9uKTtcbiAgICB9XG5cbiAgICBpZiAoIV92aWV3ZXJQYXVzZWQpIHtcbiAgICAgIGZyYW1lT2JqID0gX2ZyYW1lQ29udHJvbGxlci5nZXRGcmFtZU9iamVjdChfY3VycmVudEZyYW1lKTtcbiAgICAgIGZyYW1lT2JqLnBsYXkoKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzZXRBZGRpdGlvbmFsUGFyYW1zKG5hbWVzLCB2YWx1ZXMpIHtcbiAgICB2YXIgc3RyO1xuXG4gICAgaWYgKEFycmF5LmlzQXJyYXkobmFtZXMpICYmIG5hbWVzLmxlbmd0aCA+IDAgJiYgbmFtZXNbMF0gPT09IFwiYWRkaXRpb25hbFBhcmFtc1wiKSB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZXMpICYmIHZhbHVlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIF9hZGRpdGlvbmFsUGFyYW1zID0gSlNPTi5wYXJzZSh2YWx1ZXNbMF0pO1xuICAgICAgICBfcHJlZnMgPSBuZXcgZ2FkZ2V0cy5QcmVmcygpO1xuXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9Db250YWluZXJcIikuc3R5bGUuaGVpZ2h0ID0gX3ByZWZzLmdldEludChcInJzSFwiKSArIFwicHhcIjtcblxuICAgICAgICBfYWRkaXRpb25hbFBhcmFtcy53aWR0aCA9IF9wcmVmcy5nZXRJbnQoXCJyc1dcIik7XG4gICAgICAgIF9hZGRpdGlvbmFsUGFyYW1zLmhlaWdodCA9IF9wcmVmcy5nZXRJbnQoXCJyc0hcIik7XG5cbiAgICAgICAgX21lc3NhZ2UgPSBuZXcgUmlzZVZpc2lvbi5Db21tb24uTWVzc2FnZShkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInZpZGVvQ29udGFpbmVyXCIpLFxuICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWVzc2FnZUNvbnRhaW5lclwiKSk7XG5cbiAgICAgICAgLy8gc2hvdyB3YWl0IG1lc3NhZ2Ugd2hpbGUgU3RvcmFnZSBpbml0aWFsaXplc1xuICAgICAgICBfbWVzc2FnZS5zaG93KFwiUGxlYXNlIHdhaXQgd2hpbGUgeW91ciB2aWRlbyBpcyBkb3dubG9hZGVkLlwiKTtcblxuICAgICAgICBfZnJhbWVDb250cm9sbGVyID0gbmV3IFJpc2VWaXNpb24uQ29tbW9uLlZpZGVvLkZyYW1lQ29udHJvbGxlcigpO1xuXG4gICAgICAgIF9pc1N0b3JhZ2VGaWxlID0gKE9iamVjdC5rZXlzKF9hZGRpdGlvbmFsUGFyYW1zLnN0b3JhZ2UpLmxlbmd0aCAhPT0gMCk7XG5cbiAgICAgICAgaWYgKCFfaXNTdG9yYWdlRmlsZSkge1xuICAgICAgICAgIHN0ciA9IF9hZGRpdGlvbmFsUGFyYW1zLnVybC5zcGxpdChcIj9cIik7XG5cbiAgICAgICAgICAvLyBzdG9yZSB0aGlzIGZvciB0aGUgcmVmcmVzaCB0aW1lclxuICAgICAgICAgIF9zZXBhcmF0b3IgPSAoc3RyLmxlbmd0aCA9PT0gMSkgPyBcIj9cIiA6IFwiJlwiO1xuXG4gICAgICAgICAgX2N1cnJlbnRGaWxlID0gX2FkZGl0aW9uYWxQYXJhbXMudXJsO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gY3JlYXRlIGFuZCBpbml0aWFsaXplIHRoZSBTdG9yYWdlIG1vZHVsZSBpbnN0YW5jZVxuICAgICAgICAgIF9zdG9yYWdlID0gbmV3IFJpc2VWaXNpb24uVmlkZW8uU3RvcmFnZShfYWRkaXRpb25hbFBhcmFtcyk7XG4gICAgICAgICAgX3N0b3JhZ2UuaW5pdCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgX3JlYWR5KCk7XG5cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5ZXJFcnJvcihlcnJvcikge1xuICAgIGNvbnNvbGUuZGVidWcoXCJ2aWRlby1mb2xkZXI6OnBsYXllckVycm9yKClcIiwgZXJyb3IpO1xuXG4gICAgLy8gZmxhZyB0aGUgdmlkZW8gaGFzIGFuIGVycm9yXG4gICAgX3BsYXliYWNrRXJyb3IgPSB0cnVlO1xuXG4gICAgLy8gYWN0IGFzIHRob3VnaCB2aWRlbyBoYXMgZW5kZWRcbiAgICBwbGF5ZXJFbmRlZCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICBwYXVzZSgpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBcIm5vU3RvcmFnZUZpbGVcIjogbm9TdG9yYWdlRmlsZSxcbiAgICBcIm9uU3RvcmFnZUluaXRcIjogb25TdG9yYWdlSW5pdCxcbiAgICBcIm9uU3RvcmFnZVJlZnJlc2hcIjogb25TdG9yYWdlUmVmcmVzaCxcbiAgICBcInBhdXNlXCI6IHBhdXNlLFxuICAgIFwicGxheVwiOiBwbGF5LFxuICAgIFwic2V0QWRkaXRpb25hbFBhcmFtc1wiOiBzZXRBZGRpdGlvbmFsUGFyYW1zLFxuICAgIFwicGxheWVyRW5kZWRcIjogcGxheWVyRW5kZWQsXG4gICAgXCJwbGF5ZXJSZWFkeVwiOiBwbGF5ZXJSZWFkeSxcbiAgICBcInBsYXllckVycm9yXCI6IHBsYXllckVycm9yLFxuICAgIFwic3RvcFwiOiBzdG9wXG4gIH07XG5cbn0pKGdhZGdldHMpO1xuXHJcbi8qIGdsb2JhbCBjb25maWcgKi9cblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5WaWRlbyA9IFJpc2VWaXNpb24uVmlkZW8gfHwge307XG5cblJpc2VWaXNpb24uVmlkZW8uU3RvcmFnZSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBfaW5pdGlhbExvYWQgPSB0cnVlO1xuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICB2YXIgc3RvcmFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9TdG9yYWdlXCIpO1xuXG4gICAgaWYgKCFzdG9yYWdlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgc3RvcmFnZS5hZGRFdmVudExpc3RlbmVyKFwicmlzZS1zdG9yYWdlLXJlc3BvbnNlXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIGlmIChlLmRldGFpbCAmJiBlLmRldGFpbC51cmwpIHtcblxuICAgICAgICBpZiAoX2luaXRpYWxMb2FkKSB7XG4gICAgICAgICAgX2luaXRpYWxMb2FkID0gZmFsc2U7XG5cbiAgICAgICAgICBSaXNlVmlzaW9uLlZpZGVvLm9uU3RvcmFnZUluaXQoZS5kZXRhaWwudXJsKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAvLyBjaGVjayBmb3IgXCJjaGFuZ2VkXCIgcHJvcGVydHkgYW5kIGVuc3VyZSBpdCBpcyB0cnVlXG4gICAgICAgICAgaWYgKGUuZGV0YWlsLmhhc093blByb3BlcnR5KFwiY2hhbmdlZFwiKSAmJiBlLmRldGFpbC5jaGFuZ2VkKSB7XG4gICAgICAgICAgICBSaXNlVmlzaW9uLlZpZGVvLm9uU3RvcmFnZVJlZnJlc2goZS5kZXRhaWwudXJsKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHN0b3JhZ2UuYWRkRXZlbnRMaXN0ZW5lcihcInJpc2Utc3RvcmFnZS1uby1maWxlXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgUmlzZVZpc2lvbi5WaWRlby5ub1N0b3JhZ2VGaWxlKCk7XG4gICAgfSk7XG5cbiAgICBzdG9yYWdlLnNldEF0dHJpYnV0ZShcImZvbGRlclwiLCBkYXRhLnN0b3JhZ2UuZm9sZGVyKTtcbiAgICBzdG9yYWdlLnNldEF0dHJpYnV0ZShcImZpbGVOYW1lXCIsIGRhdGEuc3RvcmFnZS5maWxlTmFtZSk7XG4gICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJjb21wYW55SWRcIiwgZGF0YS5zdG9yYWdlLmNvbXBhbnlJZCk7XG4gICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJlbnZcIiwgY29uZmlnLlNUT1JBR0VfRU5WKTtcbiAgICBzdG9yYWdlLmdvKCk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIFwiaW5pdFwiOiBpbml0XG4gIH07XG59O1xuXHJcbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcclxuUmlzZVZpc2lvbi5Db21tb24gPSBSaXNlVmlzaW9uLkNvbW1vbiB8fCB7fTtcclxuXHJcblJpc2VWaXNpb24uQ29tbW9uLlZpZGVvID0gUmlzZVZpc2lvbi5Db21tb24uVmlkZW8gfHwge307XHJcblxyXG5SaXNlVmlzaW9uLkNvbW1vbi5WaWRlby5GcmFtZUNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gIHZhciBQUkVGSVggPSBcImlmX1wiO1xyXG5cclxuICBmdW5jdGlvbiBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFBSRUZJWCArIGluZGV4KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGdldEZyYW1lT2JqZWN0KGluZGV4KSB7XHJcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCksXHJcbiAgICAgIGlmcmFtZTtcclxuXHJcbiAgICBpZnJhbWUgPSBmcmFtZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiaWZyYW1lXCIpO1xyXG5cclxuICAgIGlmIChpZnJhbWUpIHtcclxuICAgICAgcmV0dXJuIChpZnJhbWUuY29udGVudFdpbmRvdykgPyBpZnJhbWUuY29udGVudFdpbmRvdyA6XHJcbiAgICAgICAgKGlmcmFtZS5jb250ZW50RG9jdW1lbnQuZG9jdW1lbnQpID8gaWZyYW1lLmNvbnRlbnREb2N1bWVudC5kb2N1bWVudCA6IGlmcmFtZS5jb250ZW50RG9jdW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBfY2xlYXIoaW5kZXgpIHtcclxuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGdldEZyYW1lQ29udGFpbmVyKGluZGV4KSxcclxuICAgICAgZnJhbWVPYmogPSBnZXRGcmFtZU9iamVjdChpbmRleCksXHJcbiAgICAgIGlmcmFtZTtcclxuXHJcbiAgICBpZiAoZnJhbWVPYmopIHtcclxuICAgICAgaWZyYW1lID0gZnJhbWVDb250YWluZXIucXVlcnlTZWxlY3RvcihcImlmcmFtZVwiKTtcclxuICAgICAgZnJhbWVPYmoucmVtb3ZlKCk7XHJcbiAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgXCJhYm91dDpibGFua1wiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGFkZChpbmRleCkge1xyXG4gICAgdmFyIGZyYW1lQ29udGFpbmVyID0gZ2V0RnJhbWVDb250YWluZXIoaW5kZXgpLFxyXG4gICAgICBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaWZyYW1lXCIpO1xyXG5cclxuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJhbGxvd1RyYW5zcGFyZW5jeVwiLCB0cnVlKTtcclxuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJmcmFtZWJvcmRlclwiLCBcIjBcIik7XHJcbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKFwic2Nyb2xsaW5nXCIsIFwibm9cIik7XHJcblxyXG4gICAgZnJhbWVDb250YWluZXIuYXBwZW5kQ2hpbGQoaWZyYW1lKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNyZWF0ZUZyYW1lUGxheWVyKGluZGV4LCBwYXJhbXMsIGZpbGVzLCBza2luLCBzcmMpIHtcclxuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGdldEZyYW1lQ29udGFpbmVyKGluZGV4KSxcclxuICAgICAgZnJhbWVPYmogPSBnZXRGcmFtZU9iamVjdChpbmRleCksXHJcbiAgICAgIGlmcmFtZTtcclxuXHJcbiAgICBpZiAoZnJhbWVPYmopIHtcclxuICAgICAgaWZyYW1lID0gZnJhbWVDb250YWluZXIucXVlcnlTZWxlY3RvcihcImlmcmFtZVwiKTtcclxuXHJcbiAgICAgIGlmcmFtZS5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWZyYW1lLm9ubG9hZCA9IG51bGw7XHJcblxyXG4gICAgICAgIC8vIGluaXRpYWxpemUgYW5kIGxvYWQgdGhlIHBsYXllciBpbnNpZGUgdGhlIGlmcmFtZVxyXG4gICAgICAgIGZyYW1lT2JqLmluaXQocGFyYW1zLCBmaWxlcywgc2tpbik7XHJcbiAgICAgICAgZnJhbWVPYmoubG9hZCgpO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZShcInNyY1wiLCBzcmMpO1xyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGhpZGUoaW5kZXgpIHtcclxuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGdldEZyYW1lQ29udGFpbmVyKGluZGV4KTtcclxuXHJcbiAgICBmcmFtZUNvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gXCJoaWRkZW5cIjtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHJlbW92ZShpbmRleCwgY2FsbGJhY2spIHtcclxuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFBSRUZJWCArIGluZGV4KTtcclxuXHJcbiAgICBfY2xlYXIoaW5kZXgpO1xyXG5cclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAvLyByZW1vdmUgdGhlIGlmcmFtZSBieSBjbGVhcmluZyBhbGwgZWxlbWVudHMgaW5zaWRlIGRpdiBjb250YWluZXJcclxuICAgICAgd2hpbGUgKGZyYW1lQ29udGFpbmVyLmZpcnN0Q2hpbGQpIHtcclxuICAgICAgICBmcmFtZUNvbnRhaW5lci5yZW1vdmVDaGlsZChmcmFtZUNvbnRhaW5lci5maXJzdENoaWxkKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKGNhbGxiYWNrICYmIHR5cGVvZiBjYWxsYmFjayA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgfVxyXG4gICAgfSwgMjAwKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHNob3coaW5kZXgpIHtcclxuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGdldEZyYW1lQ29udGFpbmVyKGluZGV4KTtcclxuXHJcbiAgICBmcmFtZUNvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gXCJ2aXNpYmxlXCI7XHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgYWRkOiBhZGQsXHJcbiAgICBjcmVhdGVGcmFtZVBsYXllcjogY3JlYXRlRnJhbWVQbGF5ZXIsXHJcbiAgICBnZXRGcmFtZUNvbnRhaW5lcjogZ2V0RnJhbWVDb250YWluZXIsXHJcbiAgICBnZXRGcmFtZU9iamVjdDogZ2V0RnJhbWVPYmplY3QsXHJcbiAgICBoaWRlOiBoaWRlLFxyXG4gICAgcmVtb3ZlOiByZW1vdmUsXHJcbiAgICBzaG93OiBzaG93XHJcbiAgfTtcclxufTtcclxuXHJcbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcclxuUmlzZVZpc2lvbi5Db21tb24gPSBSaXNlVmlzaW9uLkNvbW1vbiB8fCB7fTtcclxuXHJcblJpc2VWaXNpb24uQ29tbW9uLk1lc3NhZ2UgPSBmdW5jdGlvbiAobWFpbkNvbnRhaW5lciwgbWVzc2FnZUNvbnRhaW5lcikge1xyXG4gIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICB2YXIgX2FjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICBmdW5jdGlvbiBfaW5pdCgpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIG1lc3NhZ2VDb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gbWFpbkNvbnRhaW5lci5zdHlsZS5oZWlnaHQ7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybihcIkNhbid0IGluaXRpYWxpemUgTWVzc2FnZSAtIFwiLCBlLm1lc3NhZ2UpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLypcclxuICAgKiAgUHVibGljIE1ldGhvZHNcclxuICAgKi9cclxuICBmdW5jdGlvbiBoaWRlKCkge1xyXG4gICAgaWYgKF9hY3RpdmUpIHtcclxuICAgICAgLy8gY2xlYXIgY29udGVudCBvZiBtZXNzYWdlIGNvbnRhaW5lclxyXG4gICAgICB3aGlsZSAobWVzc2FnZUNvbnRhaW5lci5maXJzdENoaWxkKSB7XHJcbiAgICAgICAgbWVzc2FnZUNvbnRhaW5lci5yZW1vdmVDaGlsZChtZXNzYWdlQ29udGFpbmVyLmZpcnN0Q2hpbGQpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBoaWRlIG1lc3NhZ2UgY29udGFpbmVyXHJcbiAgICAgIG1lc3NhZ2VDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG5cclxuICAgICAgLy8gc2hvdyBtYWluIGNvbnRhaW5lclxyXG4gICAgICBtYWluQ29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHkgPSBcInZpc2libGVcIjtcclxuXHJcbiAgICAgIF9hY3RpdmUgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHNob3cobWVzc2FnZSkge1xyXG4gICAgdmFyIGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLFxyXG4gICAgICBwO1xyXG5cclxuICAgIGlmICghX2FjdGl2ZSkge1xyXG4gICAgICAvLyBoaWRlIG1haW4gY29udGFpbmVyXHJcbiAgICAgIG1haW5Db250YWluZXIuc3R5bGUudmlzaWJpbGl0eSA9IFwiaGlkZGVuXCI7XHJcblxyXG4gICAgICBtZXNzYWdlQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcblxyXG4gICAgICAvLyBjcmVhdGUgbWVzc2FnZSBlbGVtZW50XHJcbiAgICAgIHAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcclxuICAgICAgcC5pbm5lckhUTUwgPSBtZXNzYWdlO1xyXG4gICAgICBwLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwibWVzc2FnZVwiKTtcclxuICAgICAgcC5zdHlsZS5saW5lSGVpZ2h0ID0gbWVzc2FnZUNvbnRhaW5lci5zdHlsZS5oZWlnaHQ7XHJcblxyXG4gICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChwKTtcclxuICAgICAgbWVzc2FnZUNvbnRhaW5lci5hcHBlbmRDaGlsZChmcmFnbWVudCk7XHJcblxyXG4gICAgICBfYWN0aXZlID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIG1lc3NhZ2UgYWxyZWFkeSBiZWluZyBzaG93biwgdXBkYXRlIG1lc3NhZ2UgdGV4dFxyXG4gICAgICBwID0gbWVzc2FnZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLm1lc3NhZ2VcIik7XHJcbiAgICAgIHAuaW5uZXJIVE1MID0gbWVzc2FnZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9pbml0KCk7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBcImhpZGVcIjogaGlkZSxcclxuICAgIFwic2hvd1wiOiBzaG93XHJcbiAgfTtcclxufTtcclxuXHJcbi8qIGdsb2JhbCBnYWRnZXRzLCBSaXNlVmlzaW9uICovXG5cbihmdW5jdGlvbiAod2luZG93LCBnYWRnZXRzKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBwcmVmcyA9IG5ldyBnYWRnZXRzLlByZWZzKCksXG4gICAgaWQgPSBwcmVmcy5nZXRTdHJpbmcoXCJpZFwiKTtcblxuICAvLyBEaXNhYmxlIGNvbnRleHQgbWVudSAocmlnaHQgY2xpY2sgbWVudSlcbiAgd2luZG93Lm9uY29udGV4dG1lbnUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgUmlzZVZpc2lvbi5WaWRlby5wbGF5KCk7XG4gIH1cblxuICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICBSaXNlVmlzaW9uLlZpZGVvLnBhdXNlKCk7XG4gIH1cblxuICBmdW5jdGlvbiBzdG9wKCkge1xuICAgIFJpc2VWaXNpb24uVmlkZW8uc3RvcCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gcG9seW1lclJlYWR5KCkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwiV2ViQ29tcG9uZW50c1JlYWR5XCIsIHBvbHltZXJSZWFkeSk7XG5cbiAgICBpZiAoaWQgJiYgaWQgIT09IFwiXCIpIHtcbiAgICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNjbWRfcGxheV9cIiArIGlkLCBwbGF5KTtcbiAgICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNjbWRfcGF1c2VfXCIgKyBpZCwgcGF1c2UpO1xuICAgICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc2NtZF9zdG9wX1wiICsgaWQsIHN0b3ApO1xuXG4gICAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzcGFyYW1fc2V0X1wiICsgaWQsIFJpc2VWaXNpb24uVmlkZW8uc2V0QWRkaXRpb25hbFBhcmFtcyk7XG4gICAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNwYXJhbV9nZXRcIiwgbnVsbCwgaWQsIFtcImFkZGl0aW9uYWxQYXJhbXNcIl0pO1xuICAgIH1cbiAgfVxuXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiV2ViQ29tcG9uZW50c1JlYWR5XCIsIHBvbHltZXJSZWFkeSk7XG5cbn0pKHdpbmRvdywgZ2FkZ2V0cyk7XG5cblxuXHJcbi8qIGpzaGludCBpZ25vcmU6c3RhcnQgKi9cbnZhciBfZ2FxID0gX2dhcSB8fCBbXTtcblxuX2dhcS5wdXNoKFsnX3NldEFjY291bnQnLCAnVUEtNTcwOTIxNTktMiddKTtcbl9nYXEucHVzaChbJ190cmFja1BhZ2V2aWV3J10pO1xuXG4oZnVuY3Rpb24oKSB7XG4gIHZhciBnYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOyBnYS50eXBlID0gJ3RleHQvamF2YXNjcmlwdCc7IGdhLmFzeW5jID0gdHJ1ZTtcbiAgZ2Euc3JjID0gKCdodHRwczonID09IGRvY3VtZW50LmxvY2F0aW9uLnByb3RvY29sID8gJ2h0dHBzOi8vc3NsJyA6ICdodHRwOi8vd3d3JykgKyAnLmdvb2dsZS1hbmFseXRpY3MuY29tL2dhLmpzJztcbiAgdmFyIHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2NyaXB0JylbMF07IHMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZ2EsIHMpO1xufSkoKTtcbi8qIGpzaGludCBpZ25vcmU6ZW5kICovXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
