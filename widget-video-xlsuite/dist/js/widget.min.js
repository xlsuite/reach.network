function loadVideoLinkFromXLSuite(e,t){var i="2ae45fc2-72b9-45ce-9771-caf0fabf9c97";console.log("displayKey param",e),$.ajax({url:"https://rn.xlsuite.com/admin/api/liquids/call?api_key="+i+"&tag=load_screen&display_key="+e}).then(function(e){var i=e.screen.channel_url;console.log("Loaded channel URL",i);var n=i+"&amp;autoplay=1&amp;controls=0&amp;showinfo=0 frameborder=0";t(n)})}if("undefined"==typeof config){var config={SKIN:"skin/RVSkin.xml",STORAGE_ENV:"prod"};"undefined"!=typeof angular&&angular.module("risevision.common.i18n.config",[]).constant("LOCALES_PREFIX","locales/translation_").constant("LOCALES_SUFIX",".json")}var RiseVision=RiseVision||{};RiseVision.Video={},RiseVision.Video=function(e){"use strict";function t(){clearTimeout(T),T=null}function i(){e.rpc.call("","rsevent_done",null,V.getString("id"))}function n(){e.rpc.call("","rsevent_ready",null,V.getString("id"),!0,!0,!0,!0,!0)}function o(e){L=setInterval(function(){E=y.url+A+"cb="+(new Date).getTime(),C=!1},e)}function r(){t(),T=setTimeout(function(){i()},5e3)}function a(){k=!0,E="",R.show("The selected video does not exist."),b.remove(w,function(){_||r()})}function s(e){E=e,R.hide(),_||d()}function l(e){E=e,C=!1}function c(){var e=b.getFrameObject(w);return _=!0,k?(t(),void 0):(e&&e.pause(),void 0)}function d(){var e=b.getFrameObject(w);return _=!1,k?(r(),void 0):(C?i():e?e.play():E&&""!==E&&(b.add(0),b.createFramePlayer(0,y,E,config.SKIN,"player.html")),void 0)}function u(){b.remove(w,function(){i()})}function m(){var e;S||null!==L||o(I),_||(e=b.getFrameObject(w),e.play())}function f(){clearTimeout(P),P=setInterval(function(){console.log("Interval check"),loadVideoLinkFromXLSuite(h,function(e){if(e!=E){E=e;var t=$("#mainIframe");t.attr("src",E)}})},F)}function g(t,i){Array.isArray(t)&&t.length>0&&"additionalParams"===t[0]&&Array.isArray(i)&&i.length>0&&(y=JSON.parse(i[0]),V=new e.Prefs,document.getElementById("videoContainer").style.height=V.getInt("rsH")+"px",y.width=V.getInt("rsW"),y.height=V.getInt("rsH"),b=new RiseVision.Common.Video.FrameController,S=!1,h=y.displayId,loadVideoLinkFromXLSuite(h,function(e){E=e;var t=$("#mainIframe");t.attr("src",E),t.attr("width",y.width),t.attr("height",y.height),f(),n()}))}function p(e){console.debug("video-folder::playerError()",e),C=!0,u()}function v(){c()}var y,h,V=null,R=null,b=null,C=!1,S=!1,_=!0,w=0,A="",E="",I=9e5,L=null,F=5e3,T=null,k=!1,P=null;return{noStorageFile:a,onStorageInit:s,onStorageRefresh:l,pause:c,play:d,setAdditionalParams:g,playerEnded:u,playerReady:m,playerError:p,stop:v}}(gadgets);var RiseVision=RiseVision||{};RiseVision.Video=RiseVision.Video||{},RiseVision.Video.Storage=function(e){"use strict";function t(){var t=document.getElementById("videoStorage");t&&(t.addEventListener("rise-storage-response",function(e){e.detail&&e.detail.url&&(i?(i=!1,RiseVision.Video.onStorageInit(e.detail.url)):e.detail.hasOwnProperty("changed")&&e.detail.changed&&RiseVision.Video.onStorageRefresh(e.detail.url))}),t.addEventListener("rise-storage-no-file",function(){RiseVision.Video.noStorageFile()}),t.setAttribute("folder",e.storage.folder),t.setAttribute("fileName",e.storage.fileName),t.setAttribute("companyId",e.storage.companyId),t.setAttribute("env",config.STORAGE_ENV),t.go())}var i=!0;return{init:t}};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Video=RiseVision.Common.Video||{},RiseVision.Common.Video.FrameController=function(){"use strict";function e(e){return document.getElementById(l+e)}function t(t){var i,n=e(t);return i=n.querySelector("iframe"),i?i.contentWindow?i.contentWindow:i.contentDocument.document?i.contentDocument.document:i.contentDocument:null}function i(i){var n,o=e(i),r=t(i);r&&(n=o.querySelector("iframe"),r.remove(),n.setAttribute("src","about:blank"))}function n(t){var i=e(t),n=document.createElement("iframe");n.setAttribute("allowTransparency",!0),n.setAttribute("frameborder","0"),n.setAttribute("scrolling","no"),i.appendChild(n)}function o(i,n,o,r,a){var s,l=e(i),c=t(i);c&&(s=l.querySelector("iframe"),s.onload=function(){s.onload=null,c.init(n,o,r),c.load()},s.setAttribute("src",a))}function r(t){var i=e(t);i.style.visibility="hidden"}function a(e,t){var n=document.getElementById(l+e);i(e),setTimeout(function(){for(;n.firstChild;)n.removeChild(n.firstChild);t&&"function"==typeof t&&t()},200)}function s(t){var i=e(t);i.style.visibility="visible"}var l="if_";return{add:n,createFramePlayer:o,getFrameContainer:e,getFrameObject:t,hide:r,remove:a,show:s}};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Message=function(e,t){"use strict";function i(){try{t.style.height=e.style.height}catch(i){console.warn("Can't initialize Message - ",i.message)}}function n(){if(r){for(;t.firstChild;)t.removeChild(t.firstChild);t.style.display="none",e.style.visibility="visible",r=!1}}function o(i){var n,o=document.createDocumentFragment();r?(n=t.querySelector(".message"),n.innerHTML=i):(e.style.visibility="hidden",t.style.display="block",n=document.createElement("p"),n.innerHTML=i,n.setAttribute("class","message"),n.style.lineHeight=t.style.height,o.appendChild(n),t.appendChild(o),r=!0)}var r=!1;return i(),{hide:n,show:o}},function(e,t){"use strict";function i(){RiseVision.Video.play()}function n(){RiseVision.Video.pause()}function o(){RiseVision.Video.stop()}function r(){e.removeEventListener("WebComponentsReady",r),s&&""!==s&&(t.rpc.register("rscmd_play_"+s,i),t.rpc.register("rscmd_pause_"+s,n),t.rpc.register("rscmd_stop_"+s,o),t.rpc.register("rsparam_set_"+s,RiseVision.Video.setAdditionalParams),t.rpc.call("","rsparam_get",null,s,["additionalParams"]))}var a=new t.Prefs,s=a.getString("id");e.oncontextmenu=function(){return!1},e.addEventListener("WebComponentsReady",r)}(window,gadgets);var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57092159-2"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3dpZGdldC5taW4uanMiXSwibmFtZXMiOlsibG9hZFZpZGVvTGlua0Zyb21YTFN1aXRlIiwiZGlzcGxheUtleSIsImNhbGxiYWNrIiwiYXBpS2V5IiwiY29uc29sZSIsImxvZyIsIiQiLCJhamF4IiwidXJsIiwidGhlbiIsImRhdGEiLCJjaGFuZWxVcmwiLCJzY3JlZW4iLCJjaGFubmVsX3VybCIsImZ1bGxVcmwiLCJjb25maWciLCJTS0lOIiwiU1RPUkFHRV9FTlYiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uc3RhbnQiLCJSaXNlVmlzaW9uIiwiVmlkZW8iLCJnYWRnZXRzIiwiX2NsZWFyTm9GaWxlVGltZXIiLCJjbGVhclRpbWVvdXQiLCJfbm9GaWxlVGltZXIiLCJfZG9uZSIsInJwYyIsImNhbGwiLCJfcHJlZnMiLCJnZXRTdHJpbmciLCJfcmVhZHkiLCJfcmVmcmVzaEludGVydmFsIiwiZHVyYXRpb24iLCJfcmVmcmVzaEludGVydmFsSWQiLCJzZXRJbnRlcnZhbCIsIl9jdXJyZW50RmlsZSIsIl9hZGRpdGlvbmFsUGFyYW1zIiwiX3NlcGFyYXRvciIsIkRhdGUiLCJnZXRUaW1lIiwiX3BsYXliYWNrRXJyb3IiLCJfc3RhcnROb0ZpbGVUaW1lciIsInNldFRpbWVvdXQiLCJub1N0b3JhZ2VGaWxlIiwiX25vRmlsZUZsYWciLCJfbWVzc2FnZSIsInNob3ciLCJfZnJhbWVDb250cm9sbGVyIiwicmVtb3ZlIiwiX2N1cnJlbnRGcmFtZSIsIl92aWV3ZXJQYXVzZWQiLCJvblN0b3JhZ2VJbml0IiwiaGlkZSIsInBsYXkiLCJvblN0b3JhZ2VSZWZyZXNoIiwicGF1c2UiLCJmcmFtZU9iaiIsImdldEZyYW1lT2JqZWN0IiwiYWRkIiwiY3JlYXRlRnJhbWVQbGF5ZXIiLCJwbGF5ZXJFbmRlZCIsInBsYXllclJlYWR5IiwiX2lzU3RvcmFnZUZpbGUiLCJfcmVmcmVzaER1cmF0aW9uIiwic3RhcnRQbGF5bGlzdENoYW5nZVRpbWVyIiwiX3BsYXlsaXN0Q2hhbmdlVGltZXIiLCJkaXNwbGF5SWQiLCJ2aWRlb1VybCIsIiRtYWluSWZyYW1lIiwiYXR0ciIsInhsU3VpdGVQbGF5bGlzdFJlZnJlc2hEdXJhdGlvbiIsInNldEFkZGl0aW9uYWxQYXJhbXMiLCJuYW1lcyIsInZhbHVlcyIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsIkpTT04iLCJwYXJzZSIsIlByZWZzIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInN0eWxlIiwiaGVpZ2h0IiwiZ2V0SW50Iiwid2lkdGgiLCJDb21tb24iLCJGcmFtZUNvbnRyb2xsZXIiLCJwbGF5ZXJFcnJvciIsImVycm9yIiwiZGVidWciLCJzdG9wIiwiU3RvcmFnZSIsImluaXQiLCJzdG9yYWdlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJkZXRhaWwiLCJfaW5pdGlhbExvYWQiLCJoYXNPd25Qcm9wZXJ0eSIsImNoYW5nZWQiLCJzZXRBdHRyaWJ1dGUiLCJmb2xkZXIiLCJmaWxlTmFtZSIsImNvbXBhbnlJZCIsImdvIiwiZ2V0RnJhbWVDb250YWluZXIiLCJpbmRleCIsIlBSRUZJWCIsImlmcmFtZSIsImZyYW1lQ29udGFpbmVyIiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnRXaW5kb3ciLCJjb250ZW50RG9jdW1lbnQiLCJfY2xlYXIiLCJjcmVhdGVFbGVtZW50IiwiYXBwZW5kQ2hpbGQiLCJwYXJhbXMiLCJmaWxlcyIsInNraW4iLCJzcmMiLCJvbmxvYWQiLCJsb2FkIiwidmlzaWJpbGl0eSIsImZpcnN0Q2hpbGQiLCJyZW1vdmVDaGlsZCIsIk1lc3NhZ2UiLCJtYWluQ29udGFpbmVyIiwibWVzc2FnZUNvbnRhaW5lciIsIl9pbml0Iiwid2FybiIsIm1lc3NhZ2UiLCJfYWN0aXZlIiwiZGlzcGxheSIsInAiLCJmcmFnbWVudCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJpbm5lckhUTUwiLCJsaW5lSGVpZ2h0Iiwid2luZG93IiwicG9seW1lclJlYWR5IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImlkIiwicmVnaXN0ZXIiLCJwcmVmcyIsIm9uY29udGV4dG1lbnUiLCJfZ2FxIiwicHVzaCIsImdhIiwidHlwZSIsImFzeW5jIiwibG9jYXRpb24iLCJwcm90b2NvbCIsInMiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInBhcmVudE5vZGUiLCJpbnNlcnRCZWZvcmUiXSwibWFwcGluZ3MiOiJBQWlCQSxRQUFTQSwwQkFBeUJDLEVBQVlDLEdBQzVDLEdBQUlDLEdBQVMsc0NBRWJDLFNBQVFDLElBQUksbUJBQW9CSixHQUVoQ0ssRUFBRUMsTUFDQUMsSUFBSyx5REFBMkRMLEVBQVMsZ0NBQWtDRixJQUMxR1EsS0FBSyxTQUFVQyxHQUNoQixHQUFJQyxHQUFZRCxFQUFLRSxPQUFPQyxXQUc1QlQsU0FBUUMsSUFBSSxxQkFBc0JNLEVBRWxDLElBQUlHLEdBQVVILEVBQVksNkRBRTFCVCxHQUFTWSxLQTlCYixHQUFzQixtQkFBWEMsUUFBd0IsQ0FDakMsR0FBSUEsU0FDRkMsS0FBTSxrQkFDTkMsWUFBYSxPQUdRLG9CQUFaQyxVQUNUQSxRQUFRQyxPQUFPLG9DQUNaQyxTQUFTLGlCQUFrQix3QkFDM0JBLFNBQVMsZ0JBQWlCLFNBK0JqQyxHQUFJQyxZQUFhQSxjQUNqQkEsWUFBV0MsU0FFWEQsV0FBV0MsTUFBUSxTQUFXQyxHQUM1QixZQWlDQSxTQUFTQyxLQUNQQyxhQUFhQyxHQUNiQSxFQUFlLEtBR2pCLFFBQVNDLEtBQ1BKLEVBQVFLLElBQUlDLEtBQUssR0FBSSxlQUFnQixLQUFNQyxFQUFPQyxVQUFVLE9BSTlELFFBQVNDLEtBQ1BULEVBQVFLLElBQUlDLEtBQUssR0FBSSxnQkFBaUIsS0FBTUMsRUFBT0MsVUFBVSxPQUMzRCxHQUFNLEdBQU0sR0FBTSxHQUFNLEdBRzVCLFFBQVNFLEdBQWlCQyxHQUN4QkMsRUFBcUJDLFlBQVksV0FFL0JDLEVBQWVDLEVBQWtCOUIsSUFBTStCLEVBQWEsT0FBUSxHQUFJQyxPQUFPQyxVQUd2RUMsR0FBaUIsR0FFaEJSLEdBR0wsUUFBU1MsS0FDUG5CLElBRUFFLEVBQWVrQixX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QUNQbEMsV0FBV0MsTUFBTWlDLE9BR25CLFFBQVNFLEtBQ1BwQyxXQUFXQyxNQUFNbUMsUUFHbkIsUUFBU29DLEtBQ1B4RSxXQUFXQyxNQUFNdUUsT0FHbkIsUUFBU2lELEtBQ1BELEVBQU9FLG9CQUFvQixxQkFBc0JELEdBRTdDRSxHQUFhLEtBQVBBLElBQ1J6SCxFQUFRSyxJQUFJcUgsU0FBUyxjQUFnQkQsRUFBSXpGLEdBQ3pDaEMsRUFBUUssSUFBSXFILFNBQVMsZUFBaUJELEVBQUl2RixHQUMxQ2xDLEVBQVFLLElBQUlxSCxTQUFTLGNBQWdCRCxFQUFJbkQsR0FFekN0RSxFQUFRSyxJQUFJcUgsU0FBUyxlQUFpQkQsRUFBSTNILFdBQVdDLE1BQU1tRCxxQkFDM0RsRCxFQUFRSyxJQUFJQyxLQUFLLEdBQUksY0FBZSxLQUFNbUgsR0FBSyxzQkE3Qm5ELEdBQUlFLEdBQVEsR0FBSTNILEdBQVEwRCxNQUN0QitELEVBQUtFLEVBQU1uSCxVQUFVLEtBR3ZCOEcsR0FBT00sY0FBZ0IsV0FDckIsT0FBTyxHQTRCVE4sRUFBTzVDLGlCQUFpQixxQkFBc0I2QyxJQUU3Q0QsT0FBUXRILFFBS1gsSUFBSTZILE1BQU9BLFFBRVhBLE1BQUtDLE1BQU0sY0FBZSxrQkFDMUJELEtBQUtDLE1BQU0sbUJBRVgsV0FDRSxHQUFJQyxHQUFLcEUsU0FBU21DLGNBQWMsU0FBV2lDLEdBQUdDLEtBQU8sa0JBQW1CRCxFQUFHRSxPQUFRLEVBQ25GRixFQUFHNUIsS0FBTyxVQUFZeEMsU0FBU3VFLFNBQVNDLFNBQVcsY0FBZ0IsY0FBZ0IsNkJBQ25GLElBQUlDLEdBQUl6RSxTQUFTMEUscUJBQXFCLFVBQVUsRUFBSUQsR0FBRUUsV0FBV0MsYUFBYVIsRUFBSUsiLCJmaWxlIjoianMvd2lkZ2V0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGdsb2JhbCBjb25maWc6IHRydWUgKi9cbi8qIGV4cG9ydGVkIGNvbmZpZyAqL1xuaWYgKHR5cGVvZiBjb25maWcgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBTS0lOOiBcInNraW4vUlZTa2luLnhtbFwiLFxuICAgIFNUT1JBR0VfRU5WOiBcInByb2RcIlxuICB9O1xuXG4gIGlmICh0eXBlb2YgYW5ndWxhciAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIGFuZ3VsYXIubW9kdWxlKFwicmlzZXZpc2lvbi5jb21tb24uaTE4bi5jb25maWdcIiwgW10pXG4gICAgICAuY29uc3RhbnQoXCJMT0NBTEVTX1BSRUZJWFwiLCBcImxvY2FsZXMvdHJhbnNsYXRpb25fXCIpXG4gICAgICAuY29uc3RhbnQoXCJMT0NBTEVTX1NVRklYXCIsIFwiLmpzb25cIik7XG4gIH1cbn1cblxyXG4ndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIGxvYWRWaWRlb0xpbmtGcm9tWExTdWl0ZShkaXNwbGF5S2V5LCBjYWxsYmFjaykge1xuICB2YXIgYXBpS2V5ID0gXCIyYWU0NWZjMi03MmI5LTQ1Y2UtOTc3MS1jYWYwZmFiZjljOTdcIjtcblxuICBjb25zb2xlLmxvZyhcImRpc3BsYXlLZXkgcGFyYW1cIiwgZGlzcGxheUtleSk7XG5cbiAgJC5hamF4KHtcbiAgICB1cmw6IFwiaHR0cHM6Ly9ybi54bHN1aXRlLmNvbS9hZG1pbi9hcGkvbGlxdWlkcy9jYWxsP2FwaV9rZXk9XCIgKyBhcGlLZXkgKyBcIiZ0YWc9bG9hZF9zY3JlZW4mZGlzcGxheV9rZXk9XCIgKyBkaXNwbGF5S2V5XG4gIH0pLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICB2YXIgY2hhbmVsVXJsID0gZGF0YS5zY3JlZW4uY2hhbm5lbF91cmw7XG5cbiAgICAvL3RvZG86IHNhdmUgY2hhbm5lbCBVUkwgdG8gc29tZSBzZXR0aW5ncyAvIHZhcmlhYmxlXG4gICAgY29uc29sZS5sb2coXCJMb2FkZWQgY2hhbm5lbCBVUkxcIiwgY2hhbmVsVXJsKTtcblxuICAgIHZhciBmdWxsVXJsID0gY2hhbmVsVXJsICsgXCImYW1wO2F1dG9wbGF5PTEmYW1wO2NvbnRyb2xzPTAmYW1wO3Nob3dpbmZvPTAgZnJhbWVib3JkZXI9MFwiO1xuXG4gICAgY2FsbGJhY2soZnVsbFVybCk7XG5cbiAgICAvL1JOIC0gaHR0cHM6Ly93d3cueW91dHViZS5jb20vZW1iZWQvdmlkZW9zZXJpZXM/bGlzdD1QTG41NlZieE9TNzdmZC1xYlp3MG12blMyUG1fX3R2U0haXG4gICAgLy9teSAtIGh0dHBzOi8vd3d3LnlvdXR1YmUuY29tL2VtYmVkL3ZpZGVvc2VyaWVzP2xpc3Q9UEw0OFpHd0Nwd1B5RlZpRUxnc252VWtuUnpKeW8yZ09oQVxuICB9KTtcblxufVxuXHJcbi8qIGdsb2JhbCBnYWRnZXRzLCBjb25maWcgKi9cblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5WaWRlbyA9IHt9O1xuXG5SaXNlVmlzaW9uLlZpZGVvID0gKGZ1bmN0aW9uIChnYWRnZXRzKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBfYWRkaXRpb25hbFBhcmFtcztcblxuICB2YXIgX3ByZWZzID0gbnVsbCxcbiAgICBfc3RvcmFnZSA9IG51bGwsXG4gICAgX21lc3NhZ2UgPSBudWxsLFxuICAgIF9mcmFtZUNvbnRyb2xsZXIgPSBudWxsO1xuXG4gIHZhciBfcGxheWJhY2tFcnJvciA9IGZhbHNlLFxuICAgIF9pc1N0b3JhZ2VGaWxlID0gZmFsc2UsXG4gICAgX3ZpZXdlclBhdXNlZCA9IHRydWU7XG5cbiAgdmFyIF9jdXJyZW50RnJhbWUgPSAwO1xuXG4gIHZhciBfc2VwYXJhdG9yID0gXCJcIixcbiAgICBfY3VycmVudEZpbGUgPSBcIlwiO1xuXG4gIHZhciBkaXNwbGF5SWQ7XG5cbiAgdmFyIF9yZWZyZXNoRHVyYXRpb24gPSA5MDAwMDAsICAvLyAxNSBtaW51dGVzXG4gICAgX3JlZnJlc2hJbnRlcnZhbElkID0gbnVsbDtcblxuICB2YXIgeGxTdWl0ZVBsYXlsaXN0UmVmcmVzaER1cmF0aW9uID0gNTAwMDsgLy81IHNlY1xuXG4gIHZhciBfbm9GaWxlVGltZXIgPSBudWxsLFxuICAgIF9ub0ZpbGVGbGFnID0gZmFsc2U7XG5cbiAgdmFyIF9wbGF5bGlzdENoYW5nZVRpbWVyID0gbnVsbDtcblxuICAvKlxuICAgKiAgUHJpdmF0ZSBNZXRob2RzXG4gICAqL1xuICBmdW5jdGlvbiBfY2xlYXJOb0ZpbGVUaW1lcigpIHtcbiAgICBjbGVhclRpbWVvdXQoX25vRmlsZVRpbWVyKTtcbiAgICBfbm9GaWxlVGltZXIgPSBudWxsO1xuICB9XG5cbiAgZnVuY3Rpb24gX2RvbmUoKSB7XG4gICAgZ2FkZ2V0cy5ycGMuY2FsbChcIlwiLCBcInJzZXZlbnRfZG9uZVwiLCBudWxsLCBfcHJlZnMuZ2V0U3RyaW5nKFwiaWRcIikpO1xuXG4gIH1cblxuICBmdW5jdGlvbiBfcmVhZHkoKSB7XG4gICAgZ2FkZ2V0cy5ycGMuY2FsbChcIlwiLCBcInJzZXZlbnRfcmVhZHlcIiwgbnVsbCwgX3ByZWZzLmdldFN0cmluZyhcImlkXCIpLFxuICAgICAgdHJ1ZSwgdHJ1ZSwgdHJ1ZSwgdHJ1ZSwgdHJ1ZSk7XG4gIH1cblxuICBmdW5jdGlvbiBfcmVmcmVzaEludGVydmFsKGR1cmF0aW9uKSB7XG4gICAgX3JlZnJlc2hJbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gdmlkZW9SZWZyZXNoKCkge1xuICAgICAgLy8gc2V0IG5ldyB2YWx1ZSBvZiBub24gcmlzZS1zdG9yYWdlIHVybCB3aXRoIGEgY2FjaGVidXN0ZXJcbiAgICAgIF9jdXJyZW50RmlsZSA9IF9hZGRpdGlvbmFsUGFyYW1zLnVybCArIF9zZXBhcmF0b3IgKyBcImNiPVwiICsgbmV3IERhdGUoKS5nZXRUaW1lKCk7XG5cbiAgICAgIC8vIGluIGNhc2UgcmVmcmVzaGVkIGZpbGUgZml4ZXMgYW4gZXJyb3Igd2l0aCBwcmV2aW91cyBmaWxlLCBlbnN1cmUgZmxhZyBpcyByZW1vdmVkIHNvIHBsYXliYWNrIGlzIGF0dGVtcHRlZCBhZ2FpblxuICAgICAgX3BsYXliYWNrRXJyb3IgPSBmYWxzZTtcblxuICAgIH0sIGR1cmF0aW9uKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9zdGFydE5vRmlsZVRpbWVyKCkge1xuICAgIF9jbGVhck5vRmlsZVRpbWVyKCk7XG5cbiAgICBfbm9GaWxlVGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIG5vdGlmeSBWaWV3ZXIgd2lkZ2V0IGlzIGRvbmVcbiAgICAgIF9kb25lKCk7XG4gICAgfSwgNTAwMCk7XG4gIH1cblxuICAvKlxuICAgKiAgUHVibGljIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIG5vU3RvcmFnZUZpbGUoKSB7XG4gICAgX25vRmlsZUZsYWcgPSB0cnVlO1xuICAgIF9jdXJyZW50RmlsZSA9IFwiXCI7XG5cbiAgICBfbWVzc2FnZS5zaG93KFwiVGhlIHNlbGVjdGVkIHZpZGVvIGRvZXMgbm90IGV4aXN0LlwiKTtcblxuICAgIF9mcmFtZUNvbnRyb2xsZXIucmVtb3ZlKF9jdXJyZW50RnJhbWUsIGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIGlmIFdpZGdldCBpcyBwbGF5aW5nIHJpZ2h0IG5vdywgcnVuIHRoZSB0aW1lclxuICAgICAgaWYgKCFfdmlld2VyUGF1c2VkKSB7XG4gICAgICAgIF9zdGFydE5vRmlsZVRpbWVyKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBvblN0b3JhZ2VJbml0KHVybCkge1xuICAgIF9jdXJyZW50RmlsZSA9IHVybDtcblxuICAgIF9tZXNzYWdlLmhpZGUoKTtcblxuICAgIGlmICghX3ZpZXdlclBhdXNlZCkge1xuICAgICAgcGxheSgpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIG9uU3RvcmFnZVJlZnJlc2godXJsKSB7XG4gICAgX2N1cnJlbnRGaWxlID0gdXJsO1xuXG4gICAgLy8gaW4gY2FzZSByZWZyZXNoZWQgZmlsZSBmaXhlcyBhbiBlcnJvciB3aXRoIHByZXZpb3VzIGZpbGUsIGVuc3VyZSBmbGFnIGlzIHJlbW92ZWQgc28gcGxheWJhY2sgaXMgYXR0ZW1wdGVkIGFnYWluXG4gICAgX3BsYXliYWNrRXJyb3IgPSBmYWxzZTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgIHZhciBmcmFtZU9iaiA9IF9mcmFtZUNvbnRyb2xsZXIuZ2V0RnJhbWVPYmplY3QoX2N1cnJlbnRGcmFtZSk7XG5cbiAgICBfdmlld2VyUGF1c2VkID0gdHJ1ZTtcblxuICAgIGlmIChfbm9GaWxlRmxhZykge1xuICAgICAgX2NsZWFyTm9GaWxlVGltZXIoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoZnJhbWVPYmopIHtcbiAgICAgIGZyYW1lT2JqLnBhdXNlKCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcGxheSgpIHtcbiAgLy8gIGNvbnNvbGUubG9nKFwiUGxheSBldmVudCBcIik7XG4gICAgdmFyIGZyYW1lT2JqID0gX2ZyYW1lQ29udHJvbGxlci5nZXRGcmFtZU9iamVjdChfY3VycmVudEZyYW1lKTtcblxuICAgIF92aWV3ZXJQYXVzZWQgPSBmYWxzZTtcblxuICAgIGlmIChfbm9GaWxlRmxhZykge1xuICAgICAgX3N0YXJ0Tm9GaWxlVGltZXIoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIV9wbGF5YmFja0Vycm9yKSB7XG4gICAgICBpZiAoZnJhbWVPYmopIHtcbiAgICAgICAgZnJhbWVPYmoucGxheSgpO1xuICAgICAgfSBlbHNlIHtcblxuICAgICAgICBpZiAoX2N1cnJlbnRGaWxlICYmIF9jdXJyZW50RmlsZSAhPT0gXCJcIikge1xuICAgICAgICAgIC8vIGFkZCBmcmFtZSBhbmQgY3JlYXRlIHRoZSBwbGF5ZXJcbiAgICAgICAgICBfZnJhbWVDb250cm9sbGVyLmFkZCgwKTtcbiAgICAgICAgICBfZnJhbWVDb250cm9sbGVyLmNyZWF0ZUZyYW1lUGxheWVyKDAsIF9hZGRpdGlvbmFsUGFyYW1zLCBfY3VycmVudEZpbGUsIGNvbmZpZy5TS0lOLCBcInBsYXllci5odG1sXCIpO1xuICAgICAgICB9XG5cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gVGhpcyBmbGFnIG9ubHkgZ290IHNldCB1cG9uIGEgcmVmcmVzaCBvZiBoaWRkZW4gZnJhbWUgYW5kIHRoZXJlIHdhcyBhbiBlcnJvciBpbiBzZXR1cCBvciB2aWRlb1xuICAgICAgLy8gU2VuZCBWaWV3ZXIgXCJkb25lXCJcbiAgICAgIF9kb25lKCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcGxheWVyRW5kZWQoKSB7XG4gICAgX2ZyYW1lQ29udHJvbGxlci5yZW1vdmUoX2N1cnJlbnRGcmFtZSwgZnVuY3Rpb24gKCkge1xuICAgICAgX2RvbmUoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYXllclJlYWR5KCkge1xuICAgIHZhciBmcmFtZU9iajtcblxuICAgIC8vIG5vbi1zdG9yYWdlLCBjaGVjayBpZiByZWZyZXNoIGludGVydmFsIGV4aXN0cyB5ZXQsIHN0YXJ0IGl0IGlmIG5vdFxuICAgIGlmICghX2lzU3RvcmFnZUZpbGUgJiYgX3JlZnJlc2hJbnRlcnZhbElkID09PSBudWxsKSB7XG4gICAgICBfcmVmcmVzaEludGVydmFsKF9yZWZyZXNoRHVyYXRpb24pO1xuICAgIH1cblxuICAgIGlmICghX3ZpZXdlclBhdXNlZCkge1xuICAgICAgZnJhbWVPYmogPSBfZnJhbWVDb250cm9sbGVyLmdldEZyYW1lT2JqZWN0KF9jdXJyZW50RnJhbWUpO1xuICAgICAgZnJhbWVPYmoucGxheSgpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHN0YXJ0UGxheWxpc3RDaGFuZ2VUaW1lcigpIHtcbiAgICBjbGVhclRpbWVvdXQoX3BsYXlsaXN0Q2hhbmdlVGltZXIpO1xuXG4gICAgX3BsYXlsaXN0Q2hhbmdlVGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIkludGVydmFsIGNoZWNrXCIpO1xuXG4gICAgICBsb2FkVmlkZW9MaW5rRnJvbVhMU3VpdGUoZGlzcGxheUlkLCBmdW5jdGlvbiAodmlkZW9VcmwpIHtcbiAgICAgICAgaWYgKHZpZGVvVXJsICE9IF9jdXJyZW50RmlsZSkge1xuICAgICAgICAgIF9jdXJyZW50RmlsZSA9IHZpZGVvVXJsO1xuICAgICAgICAgIHZhciAkbWFpbklmcmFtZSA9ICQoJyNtYWluSWZyYW1lJyk7XG4gICAgICAgICAgJG1haW5JZnJhbWUuYXR0cignc3JjJywgX2N1cnJlbnRGaWxlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICB9LCB4bFN1aXRlUGxheWxpc3RSZWZyZXNoRHVyYXRpb24pO1xuICB9XG5cbiAgZnVuY3Rpb24gc2V0QWRkaXRpb25hbFBhcmFtcyhuYW1lcywgdmFsdWVzKSB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkobmFtZXMpICYmIG5hbWVzLmxlbmd0aCA+IDAgJiYgbmFtZXNbMF0gPT09IFwiYWRkaXRpb25hbFBhcmFtc1wiKSB7XG4gICAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZXMpICYmIHZhbHVlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIF9hZGRpdGlvbmFsUGFyYW1zID0gSlNPTi5wYXJzZSh2YWx1ZXNbMF0pO1xuICAgICAgICBfcHJlZnMgPSBuZXcgZ2FkZ2V0cy5QcmVmcygpO1xuXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9Db250YWluZXJcIikuc3R5bGUuaGVpZ2h0ID0gX3ByZWZzLmdldEludChcInJzSFwiKSArIFwicHhcIjtcblxuICAgICAgICBfYWRkaXRpb25hbFBhcmFtcy53aWR0aCA9IF9wcmVmcy5nZXRJbnQoXCJyc1dcIik7XG4gICAgICAgIF9hZGRpdGlvbmFsUGFyYW1zLmhlaWdodCA9IF9wcmVmcy5nZXRJbnQoXCJyc0hcIik7XG5cbiAgICAgICAgX2ZyYW1lQ29udHJvbGxlciA9IG5ldyBSaXNlVmlzaW9uLkNvbW1vbi5WaWRlby5GcmFtZUNvbnRyb2xsZXIoKTtcblxuICAgICAgICBfaXNTdG9yYWdlRmlsZSA9IGZhbHNlO1xuXG4gICAgICAgIGRpc3BsYXlJZCA9IF9hZGRpdGlvbmFsUGFyYW1zLmRpc3BsYXlJZDtcblxuICAgICAgICBsb2FkVmlkZW9MaW5rRnJvbVhMU3VpdGUoZGlzcGxheUlkLCBmdW5jdGlvbiAodmlkZW9VcmwpIHtcbiAgICAgICAgICBfY3VycmVudEZpbGUgPSB2aWRlb1VybDtcblxuICAgICAgICAgIHZhciAkbWFpbklmcmFtZSA9ICQoJyNtYWluSWZyYW1lJyk7XG4gICAgICAgICAgJG1haW5JZnJhbWUuYXR0cignc3JjJywgX2N1cnJlbnRGaWxlKTtcbiAgICAgICAgICAkbWFpbklmcmFtZS5hdHRyKCd3aWR0aCcsIF9hZGRpdGlvbmFsUGFyYW1zLndpZHRoKTtcbiAgICAgICAgICAkbWFpbklmcmFtZS5hdHRyKCdoZWlnaHQnLCBfYWRkaXRpb25hbFBhcmFtcy5oZWlnaHQpO1xuXG4gICAgICAgICAgc3RhcnRQbGF5bGlzdENoYW5nZVRpbWVyKCk7XG5cbiAgICAgICAgICBfcmVhZHkoKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcGxheWVyRXJyb3IoZXJyb3IpIHtcbiAgICBjb25zb2xlLmRlYnVnKFwidmlkZW8tZm9sZGVyOjpwbGF5ZXJFcnJvcigpXCIsIGVycm9yKTtcblxuICAgIC8vIGZsYWcgdGhlIHZpZGVvIGhhcyBhbiBlcnJvclxuICAgIF9wbGF5YmFja0Vycm9yID0gdHJ1ZTtcblxuICAgIC8vIGFjdCBhcyB0aG91Z2ggdmlkZW8gaGFzIGVuZGVkXG4gICAgcGxheWVyRW5kZWQoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgcGF1c2UoKTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgXCJub1N0b3JhZ2VGaWxlXCI6IG5vU3RvcmFnZUZpbGUsXG4gICAgXCJvblN0b3JhZ2VJbml0XCI6IG9uU3RvcmFnZUluaXQsXG4gICAgXCJvblN0b3JhZ2VSZWZyZXNoXCI6IG9uU3RvcmFnZVJlZnJlc2gsXG4gICAgXCJwYXVzZVwiOiBwYXVzZSxcbiAgICBcInBsYXlcIjogcGxheSxcbiAgICBcInNldEFkZGl0aW9uYWxQYXJhbXNcIjogc2V0QWRkaXRpb25hbFBhcmFtcyxcbiAgICBcInBsYXllckVuZGVkXCI6IHBsYXllckVuZGVkLFxuICAgIFwicGxheWVyUmVhZHlcIjogcGxheWVyUmVhZHksXG4gICAgXCJwbGF5ZXJFcnJvclwiOiBwbGF5ZXJFcnJvcixcbiAgICBcInN0b3BcIjogc3RvcFxuICB9O1xuXG59KShnYWRnZXRzKTtcblxyXG4vKiBnbG9iYWwgY29uZmlnICovXG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uVmlkZW8gPSBSaXNlVmlzaW9uLlZpZGVvIHx8IHt9O1xuXG5SaXNlVmlzaW9uLlZpZGVvLlN0b3JhZ2UgPSBmdW5jdGlvbiAoZGF0YSkge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgX2luaXRpYWxMb2FkID0gdHJ1ZTtcblxuICAvKlxuICAgKiAgUHVibGljIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgdmFyIHN0b3JhZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInZpZGVvU3RvcmFnZVwiKTtcblxuICAgIGlmICghc3RvcmFnZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHN0b3JhZ2UuYWRkRXZlbnRMaXN0ZW5lcihcInJpc2Utc3RvcmFnZS1yZXNwb25zZVwiLCBmdW5jdGlvbihlKSB7XG4gICAgICBpZiAoZS5kZXRhaWwgJiYgZS5kZXRhaWwudXJsKSB7XG5cbiAgICAgICAgaWYgKF9pbml0aWFsTG9hZCkge1xuICAgICAgICAgIF9pbml0aWFsTG9hZCA9IGZhbHNlO1xuXG4gICAgICAgICAgUmlzZVZpc2lvbi5WaWRlby5vblN0b3JhZ2VJbml0KGUuZGV0YWlsLnVybCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgLy8gY2hlY2sgZm9yIFwiY2hhbmdlZFwiIHByb3BlcnR5IGFuZCBlbnN1cmUgaXQgaXMgdHJ1ZVxuICAgICAgICAgIGlmIChlLmRldGFpbC5oYXNPd25Qcm9wZXJ0eShcImNoYW5nZWRcIikgJiYgZS5kZXRhaWwuY2hhbmdlZCkge1xuICAgICAgICAgICAgUmlzZVZpc2lvbi5WaWRlby5vblN0b3JhZ2VSZWZyZXNoKGUuZGV0YWlsLnVybCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBzdG9yYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJyaXNlLXN0b3JhZ2Utbm8tZmlsZVwiLCBmdW5jdGlvbigpIHtcbiAgICAgIFJpc2VWaXNpb24uVmlkZW8ubm9TdG9yYWdlRmlsZSgpO1xuICAgIH0pO1xuXG4gICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJmb2xkZXJcIiwgZGF0YS5zdG9yYWdlLmZvbGRlcik7XG4gICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJmaWxlTmFtZVwiLCBkYXRhLnN0b3JhZ2UuZmlsZU5hbWUpO1xuICAgIHN0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiY29tcGFueUlkXCIsIGRhdGEuc3RvcmFnZS5jb21wYW55SWQpO1xuICAgIHN0b3JhZ2Uuc2V0QXR0cmlidXRlKFwiZW52XCIsIGNvbmZpZy5TVE9SQUdFX0VOVik7XG4gICAgc3RvcmFnZS5nbygpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBcImluaXRcIjogaW5pdFxuICB9O1xufTtcblxyXG52YXIgUmlzZVZpc2lvbiA9IFJpc2VWaXNpb24gfHwge307XHJcblJpc2VWaXNpb24uQ29tbW9uID0gUmlzZVZpc2lvbi5Db21tb24gfHwge307XHJcblxyXG5SaXNlVmlzaW9uLkNvbW1vbi5WaWRlbyA9IFJpc2VWaXNpb24uQ29tbW9uLlZpZGVvIHx8IHt9O1xyXG5cclxuUmlzZVZpc2lvbi5Db21tb24uVmlkZW8uRnJhbWVDb250cm9sbGVyID0gZnVuY3Rpb24gKCkge1xyXG4gIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICB2YXIgUFJFRklYID0gXCJpZl9cIjtcclxuXHJcbiAgZnVuY3Rpb24gZ2V0RnJhbWVDb250YWluZXIoaW5kZXgpIHtcclxuICAgIHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChQUkVGSVggKyBpbmRleCk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBnZXRGcmFtZU9iamVjdChpbmRleCkge1xyXG4gICAgdmFyIGZyYW1lQ29udGFpbmVyID0gZ2V0RnJhbWVDb250YWluZXIoaW5kZXgpLFxyXG4gICAgICBpZnJhbWU7XHJcblxyXG4gICAgaWZyYW1lID0gZnJhbWVDb250YWluZXIucXVlcnlTZWxlY3RvcihcImlmcmFtZVwiKTtcclxuXHJcbiAgICBpZiAoaWZyYW1lKSB7XHJcbiAgICAgIHJldHVybiAoaWZyYW1lLmNvbnRlbnRXaW5kb3cpID8gaWZyYW1lLmNvbnRlbnRXaW5kb3cgOlxyXG4gICAgICAgIChpZnJhbWUuY29udGVudERvY3VtZW50LmRvY3VtZW50KSA/IGlmcmFtZS5jb250ZW50RG9jdW1lbnQuZG9jdW1lbnQgOiBpZnJhbWUuY29udGVudERvY3VtZW50O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gX2NsZWFyKGluZGV4KSB7XHJcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCksXHJcbiAgICAgIGZyYW1lT2JqID0gZ2V0RnJhbWVPYmplY3QoaW5kZXgpLFxyXG4gICAgICBpZnJhbWU7XHJcblxyXG4gICAgaWYgKGZyYW1lT2JqKSB7XHJcbiAgICAgIGlmcmFtZSA9IGZyYW1lQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCJpZnJhbWVcIik7XHJcbiAgICAgIGZyYW1lT2JqLnJlbW92ZSgpO1xyXG4gICAgICBpZnJhbWUuc2V0QXR0cmlidXRlKFwic3JjXCIsIFwiYWJvdXQ6YmxhbmtcIik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBhZGQoaW5kZXgpIHtcclxuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGdldEZyYW1lQ29udGFpbmVyKGluZGV4KSxcclxuICAgICAgaWZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlmcmFtZVwiKTtcclxuXHJcbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKFwiYWxsb3dUcmFuc3BhcmVuY3lcIiwgdHJ1ZSk7XHJcbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKFwiZnJhbWVib3JkZXJcIiwgXCIwXCIpO1xyXG4gICAgaWZyYW1lLnNldEF0dHJpYnV0ZShcInNjcm9sbGluZ1wiLCBcIm5vXCIpO1xyXG5cclxuICAgIGZyYW1lQ29udGFpbmVyLmFwcGVuZENoaWxkKGlmcmFtZSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBjcmVhdGVGcmFtZVBsYXllcihpbmRleCwgcGFyYW1zLCBmaWxlcywgc2tpbiwgc3JjKSB7XHJcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCksXHJcbiAgICAgIGZyYW1lT2JqID0gZ2V0RnJhbWVPYmplY3QoaW5kZXgpLFxyXG4gICAgICBpZnJhbWU7XHJcblxyXG4gICAgaWYgKGZyYW1lT2JqKSB7XHJcbiAgICAgIGlmcmFtZSA9IGZyYW1lQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCJpZnJhbWVcIik7XHJcblxyXG4gICAgICBpZnJhbWUub25sb2FkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmcmFtZS5vbmxvYWQgPSBudWxsO1xyXG5cclxuICAgICAgICAvLyBpbml0aWFsaXplIGFuZCBsb2FkIHRoZSBwbGF5ZXIgaW5zaWRlIHRoZSBpZnJhbWVcclxuICAgICAgICBmcmFtZU9iai5pbml0KHBhcmFtcywgZmlsZXMsIHNraW4pO1xyXG4gICAgICAgIGZyYW1lT2JqLmxvYWQoKTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgc3JjKTtcclxuICAgIH1cclxuXHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBoaWRlKGluZGV4KSB7XHJcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCk7XHJcblxyXG4gICAgZnJhbWVDb250YWluZXIuc3R5bGUudmlzaWJpbGl0eSA9IFwiaGlkZGVuXCI7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiByZW1vdmUoaW5kZXgsIGNhbGxiYWNrKSB7XHJcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChQUkVGSVggKyBpbmRleCk7XHJcblxyXG4gICAgX2NsZWFyKGluZGV4KTtcclxuXHJcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgLy8gcmVtb3ZlIHRoZSBpZnJhbWUgYnkgY2xlYXJpbmcgYWxsIGVsZW1lbnRzIGluc2lkZSBkaXYgY29udGFpbmVyXHJcbiAgICAgIHdoaWxlIChmcmFtZUNvbnRhaW5lci5maXJzdENoaWxkKSB7XHJcbiAgICAgICAgZnJhbWVDb250YWluZXIucmVtb3ZlQ2hpbGQoZnJhbWVDb250YWluZXIuZmlyc3RDaGlsZCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChjYWxsYmFjayAmJiB0eXBlb2YgY2FsbGJhY2sgPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgIH1cclxuICAgIH0sIDIwMCk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBzaG93KGluZGV4KSB7XHJcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCk7XHJcblxyXG4gICAgZnJhbWVDb250YWluZXIuc3R5bGUudmlzaWJpbGl0eSA9IFwidmlzaWJsZVwiO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGFkZDogYWRkLFxyXG4gICAgY3JlYXRlRnJhbWVQbGF5ZXI6IGNyZWF0ZUZyYW1lUGxheWVyLFxyXG4gICAgZ2V0RnJhbWVDb250YWluZXI6IGdldEZyYW1lQ29udGFpbmVyLFxyXG4gICAgZ2V0RnJhbWVPYmplY3Q6IGdldEZyYW1lT2JqZWN0LFxyXG4gICAgaGlkZTogaGlkZSxcclxuICAgIHJlbW92ZTogcmVtb3ZlLFxyXG4gICAgc2hvdzogc2hvd1xyXG4gIH07XHJcbn07XHJcblxyXG52YXIgUmlzZVZpc2lvbiA9IFJpc2VWaXNpb24gfHwge307XHJcblJpc2VWaXNpb24uQ29tbW9uID0gUmlzZVZpc2lvbi5Db21tb24gfHwge307XHJcblxyXG5SaXNlVmlzaW9uLkNvbW1vbi5NZXNzYWdlID0gZnVuY3Rpb24gKG1haW5Db250YWluZXIsIG1lc3NhZ2VDb250YWluZXIpIHtcclxuICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgdmFyIF9hY3RpdmUgPSBmYWxzZTtcclxuXHJcbiAgZnVuY3Rpb24gX2luaXQoKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBtZXNzYWdlQ29udGFpbmVyLnN0eWxlLmhlaWdodCA9IG1haW5Db250YWluZXIuc3R5bGUuaGVpZ2h0O1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBjb25zb2xlLndhcm4oXCJDYW4ndCBpbml0aWFsaXplIE1lc3NhZ2UgLSBcIiwgZS5tZXNzYWdlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qXHJcbiAgICogIFB1YmxpYyBNZXRob2RzXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gaGlkZSgpIHtcclxuICAgIGlmIChfYWN0aXZlKSB7XHJcbiAgICAgIC8vIGNsZWFyIGNvbnRlbnQgb2YgbWVzc2FnZSBjb250YWluZXJcclxuICAgICAgd2hpbGUgKG1lc3NhZ2VDb250YWluZXIuZmlyc3RDaGlsZCkge1xyXG4gICAgICAgIG1lc3NhZ2VDb250YWluZXIucmVtb3ZlQ2hpbGQobWVzc2FnZUNvbnRhaW5lci5maXJzdENoaWxkKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gaGlkZSBtZXNzYWdlIGNvbnRhaW5lclxyXG4gICAgICBtZXNzYWdlQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuXHJcbiAgICAgIC8vIHNob3cgbWFpbiBjb250YWluZXJcclxuICAgICAgbWFpbkNvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gXCJ2aXNpYmxlXCI7XHJcblxyXG4gICAgICBfYWN0aXZlID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBzaG93KG1lc3NhZ2UpIHtcclxuICAgIHZhciBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSxcclxuICAgICAgcDtcclxuXHJcbiAgICBpZiAoIV9hY3RpdmUpIHtcclxuICAgICAgLy8gaGlkZSBtYWluIGNvbnRhaW5lclxyXG4gICAgICBtYWluQ29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xyXG5cclxuICAgICAgbWVzc2FnZUNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG5cclxuICAgICAgLy8gY3JlYXRlIG1lc3NhZ2UgZWxlbWVudFxyXG4gICAgICBwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XHJcbiAgICAgIHAuaW5uZXJIVE1MID0gbWVzc2FnZTtcclxuICAgICAgcC5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcIm1lc3NhZ2VcIik7XHJcbiAgICAgIHAuc3R5bGUubGluZUhlaWdodCA9IG1lc3NhZ2VDb250YWluZXIuc3R5bGUuaGVpZ2h0O1xyXG5cclxuICAgICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQocCk7XHJcbiAgICAgIG1lc3NhZ2VDb250YWluZXIuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xyXG5cclxuICAgICAgX2FjdGl2ZSA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBtZXNzYWdlIGFscmVhZHkgYmVpbmcgc2hvd24sIHVwZGF0ZSBtZXNzYWdlIHRleHRcclxuICAgICAgcCA9IG1lc3NhZ2VDb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5tZXNzYWdlXCIpO1xyXG4gICAgICBwLmlubmVySFRNTCA9IG1lc3NhZ2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaW5pdCgpO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgXCJoaWRlXCI6IGhpZGUsXHJcbiAgICBcInNob3dcIjogc2hvd1xyXG4gIH07XHJcbn07XHJcblxyXG4vKiBnbG9iYWwgZ2FkZ2V0cywgUmlzZVZpc2lvbiAqL1xuXG4oZnVuY3Rpb24gKHdpbmRvdywgZ2FkZ2V0cykge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgcHJlZnMgPSBuZXcgZ2FkZ2V0cy5QcmVmcygpLFxuICAgIGlkID0gcHJlZnMuZ2V0U3RyaW5nKFwiaWRcIik7XG5cbiAgLy8gRGlzYWJsZSBjb250ZXh0IG1lbnUgKHJpZ2h0IGNsaWNrIG1lbnUpXG4gIHdpbmRvdy5vbmNvbnRleHRtZW51ID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICBmdW5jdGlvbiBwbGF5KCkge1xuICAgIFJpc2VWaXNpb24uVmlkZW8ucGxheSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgUmlzZVZpc2lvbi5WaWRlby5wYXVzZSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICBSaXNlVmlzaW9uLlZpZGVvLnN0b3AoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBvbHltZXJSZWFkeSgpIHtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIldlYkNvbXBvbmVudHNSZWFkeVwiLCBwb2x5bWVyUmVhZHkpO1xuXG4gICAgaWYgKGlkICYmIGlkICE9PSBcIlwiKSB7XG4gICAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzY21kX3BsYXlfXCIgKyBpZCwgcGxheSk7XG4gICAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzY21kX3BhdXNlX1wiICsgaWQsIHBhdXNlKTtcbiAgICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNjbWRfc3RvcF9cIiArIGlkLCBzdG9wKTtcblxuICAgICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc3BhcmFtX3NldF9cIiArIGlkLCBSaXNlVmlzaW9uLlZpZGVvLnNldEFkZGl0aW9uYWxQYXJhbXMpO1xuICAgICAgZ2FkZ2V0cy5ycGMuY2FsbChcIlwiLCBcInJzcGFyYW1fZ2V0XCIsIG51bGwsIGlkLCBbXCJhZGRpdGlvbmFsUGFyYW1zXCJdKTtcbiAgICB9XG4gIH1cblxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIldlYkNvbXBvbmVudHNSZWFkeVwiLCBwb2x5bWVyUmVhZHkpO1xuXG59KSh3aW5kb3csIGdhZGdldHMpO1xuXG5cblxyXG4vKiBqc2hpbnQgaWdub3JlOnN0YXJ0ICovXG52YXIgX2dhcSA9IF9nYXEgfHwgW107XG5cbl9nYXEucHVzaChbJ19zZXRBY2NvdW50JywgJ1VBLTU3MDkyMTU5LTInXSk7XG5fZ2FxLnB1c2goWydfdHJhY2tQYWdldmlldyddKTtcblxuKGZ1bmN0aW9uKCkge1xuICB2YXIgZ2EgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsgZ2EudHlwZSA9ICd0ZXh0L2phdmFzY3JpcHQnOyBnYS5hc3luYyA9IHRydWU7XG4gIGdhLnNyYyA9ICgnaHR0cHM6JyA9PSBkb2N1bWVudC5sb2NhdGlvbi5wcm90b2NvbCA/ICdodHRwczovL3NzbCcgOiAnaHR0cDovL3d3dycpICsgJy5nb29nbGUtYW5hbHl0aWNzLmNvbS9nYS5qcyc7XG4gIHZhciBzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpWzBdOyBzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGdhLCBzKTtcbn0pKCk7XG4vKiBqc2hpbnQgaWdub3JlOmVuZCAqL1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
