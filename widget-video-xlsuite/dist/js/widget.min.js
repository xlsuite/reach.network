if("undefined"==typeof config){var config={SKIN:"skin/RVSkin.xml",STORAGE_ENV:"prod"};"undefined"!=typeof angular&&angular.module("risevision.common.i18n.config",[]).constant("LOCALES_PREFIX","locales/translation_").constant("LOCALES_SUFIX",".json")}var RiseVision=RiseVision||{};RiseVision.Video={},RiseVision.Video=function(e){"use strict";function t(){clearTimeout(I),I=null}function i(){e.rpc.call("","rsevent_done",null,y.getString("id"))}function n(){e.rpc.call("","rsevent_ready",null,y.getString("id"),!0,!0,!0,!0,!0)}function o(e){w=setInterval(function(){A=v.url+_+"cb="+(new Date).getTime(),R=!1},e)}function r(){t(),I=setTimeout(function(){i()},5e3)}function s(){F=!0,A="",V.show("The selected video does not exist."),h.remove(S,function(){C||r()})}function a(e){A=e,V.hide(),C||u()}function l(e){A=e,R=!1}function c(){var e=h.getFrameObject(S);return C=!0,F?(t(),void 0):(e&&e.pause(),void 0)}function u(){var e=h.getFrameObject(S);return C=!1,F?(r(),void 0):(R?i():e?e.play():A&&""!==A&&(h.add(0),h.createFramePlayer(0,v,A,config.SKIN,"player.html")),void 0)}function d(){h.remove(S,function(){i()})}function m(){var e;b||null!==w||o(E),C||(e=h.getFrameObject(S),e.play())}function f(t,i){var o;Array.isArray(t)&&t.length>0&&"additionalParams"===t[0]&&Array.isArray(i)&&i.length>0&&(v=JSON.parse(i[0]),y=new e.Prefs,document.getElementById("videoContainer").style.height=y.getInt("rsH")+"px",v.width=y.getInt("rsW"),v.height=y.getInt("rsH"),h=new RiseVision.Common.Video.FrameController,b=!1,b||(o=v.url.split("?"),_=1===o.length?"?":"&",A=v.url),n())}function g(e){console.debug("video-folder::playerError()",e),R=!0,d()}function p(){c()}var v,y=null,V=null,h=null,R=!1,b=!1,C=!0,S=0,_="",A="",E=9e5,w=null,I=null,F=!1;return{noStorageFile:s,onStorageInit:a,onStorageRefresh:l,pause:c,play:u,setAdditionalParams:f,playerEnded:d,playerReady:m,playerError:g,stop:p}}(gadgets);var RiseVision=RiseVision||{};RiseVision.Video=RiseVision.Video||{},RiseVision.Video.Storage=function(e){"use strict";function t(){var t=document.getElementById("videoStorage");t&&(t.addEventListener("rise-storage-response",function(e){e.detail&&e.detail.url&&(i?(i=!1,RiseVision.Video.onStorageInit(e.detail.url)):e.detail.hasOwnProperty("changed")&&e.detail.changed&&RiseVision.Video.onStorageRefresh(e.detail.url))}),t.addEventListener("rise-storage-no-file",function(){RiseVision.Video.noStorageFile()}),t.setAttribute("folder",e.storage.folder),t.setAttribute("fileName",e.storage.fileName),t.setAttribute("companyId",e.storage.companyId),t.setAttribute("env",config.STORAGE_ENV),t.go())}var i=!0;return{init:t}};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Video=RiseVision.Common.Video||{},RiseVision.Common.Video.FrameController=function(){"use strict";function e(e){return document.getElementById(l+e)}function t(t){var i,n=e(t);return i=n.querySelector("iframe"),i?i.contentWindow?i.contentWindow:i.contentDocument.document?i.contentDocument.document:i.contentDocument:null}function i(i){var n,o=e(i),r=t(i);r&&(n=o.querySelector("iframe"),r.remove(),n.setAttribute("src","about:blank"))}function n(t){var i=e(t),n=document.createElement("iframe");n.setAttribute("allowTransparency",!0),n.setAttribute("frameborder","0"),n.setAttribute("scrolling","no"),i.appendChild(n)}function o(i,n,o,r,s){var a,l=e(i),c=t(i);c&&(a=l.querySelector("iframe"),a.onload=function(){a.onload=null,c.init(n,o,r),c.load()},a.setAttribute("src",s))}function r(t){var i=e(t);i.style.visibility="hidden"}function s(e,t){var n=document.getElementById(l+e);i(e),setTimeout(function(){for(;n.firstChild;)n.removeChild(n.firstChild);t&&"function"==typeof t&&t()},200)}function a(t){var i=e(t);i.style.visibility="visible"}var l="if_";return{add:n,createFramePlayer:o,getFrameContainer:e,getFrameObject:t,hide:r,remove:s,show:a}};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Message=function(e,t){"use strict";function i(){try{t.style.height=e.style.height}catch(i){console.warn("Can't initialize Message - ",i.message)}}function n(){if(r){for(;t.firstChild;)t.removeChild(t.firstChild);t.style.display="none",e.style.visibility="visible",r=!1}}function o(i){var n,o=document.createDocumentFragment();r?(n=t.querySelector(".message"),n.innerHTML=i):(e.style.visibility="hidden",t.style.display="block",n=document.createElement("p"),n.innerHTML=i,n.setAttribute("class","message"),n.style.lineHeight=t.style.height,o.appendChild(n),t.appendChild(o),r=!0)}var r=!1;return i(),{hide:n,show:o}},function(e,t){"use strict";function i(){RiseVision.Video.play()}function n(){RiseVision.Video.pause()}function o(){RiseVision.Video.stop()}function r(){e.removeEventListener("WebComponentsReady",r),a&&""!==a&&(t.rpc.register("rscmd_play_"+a,i),t.rpc.register("rscmd_pause_"+a,n),t.rpc.register("rscmd_stop_"+a,o),t.rpc.register("rsparam_set_"+a,RiseVision.Video.setAdditionalParams),t.rpc.call("","rsparam_get",null,a,["additionalParams"]))}var s=new t.Prefs,a=s.getString("id");e.oncontextmenu=function(){return!1},e.addEventListener("WebComponentsReady",r)}(window,gadgets);var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57092159-2"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3dpZGdldC5taW4uanMiXSwibmFtZXMiOlsiY29uZmlnIiwiU0tJTiIsIlNUT1JBR0VfRU5WIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbnN0YW50IiwiUmlzZVZpc2lvbiIsIlZpZGVvIiwiZ2FkZ2V0cyIsIl9jbGVhck5vRmlsZVRpbWVyIiwiY2xlYXJUaW1lb3V0IiwiX25vRmlsZVRpbWVyIiwiX2RvbmUiLCJycGMiLCJjYWxsIiwiX3ByZWZzIiwiZ2V0U3RyaW5nIiwiX3JlYWR5IiwiX3JlZnJlc2hJbnRlcnZhbCIsImR1cmF0aW9uIiwiX3JlZnJlc2hJbnRlcnZhbElkIiwic2V0SW50ZXJ2YWwiLCJfY3VycmVudEZpbGUiLCJfYWRkaXRpb25hbFBhcmFtcyIsInVybCIsIl9zZXBhcmF0b3IiLCJEYXRlIiwiZ2V0VGltZSIsIl9wbGF5YmFja0Vycm9yIiwiX3N0YXJ0Tm9GaWxlVGltZXIiLCJzZXRUaW1lb3V0Iiwibm9TdG9yYWdlRmlsZSIsIl9ub0ZpbGVGbGFnIiwiX21lc3NhZ2UiLCJzaG93IiwiX2ZyYW1lQ29udHJvbGxlciIsInJlbW92ZSIsIl9jdXJyZW50RnJhbWUiLCJfdmlld2VyUGF1c2VkIiwib25TdG9yYWdlSW5pdCIsImhpZGUiLCJwbGF5Iiwib25TdG9yYWdlUmVmcmVzaCIsInBhdXNlIiwiZnJhbWVPYmoiLCJnZXRGcmFtZU9iamVjdCIsImFkZCIsImNyZWF0ZUZyYW1lUGxheWVyIiwicGxheWVyRW5kZWQiLCJwbGF5ZXJSZWFkeSIsIl9pc1N0b3JhZ2VGaWxlIiwiX3JlZnJlc2hEdXJhdGlvbiIsInNldEFkZGl0aW9uYWxQYXJhbXMiLCJuYW1lcyIsInZhbHVlcyIsInN0ciIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsIkpTT04iLCJwYXJzZSIsIlByZWZzIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInN0eWxlIiwiaGVpZ2h0IiwiZ2V0SW50Iiwid2lkdGgiLCJDb21tb24iLCJGcmFtZUNvbnRyb2xsZXIiLCJzcGxpdCIsInBsYXllckVycm9yIiwiZXJyb3IiLCJjb25zb2xlIiwiZGVidWciLCJzdG9wIiwiU3RvcmFnZSIsImRhdGEiLCJpbml0Iiwic3RvcmFnZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiZGV0YWlsIiwiX2luaXRpYWxMb2FkIiwiaGFzT3duUHJvcGVydHkiLCJjaGFuZ2VkIiwic2V0QXR0cmlidXRlIiwiZm9sZGVyIiwiZmlsZU5hbWUiLCJjb21wYW55SWQiLCJnbyIsImdldEZyYW1lQ29udGFpbmVyIiwiaW5kZXgiLCJQUkVGSVgiLCJpZnJhbWUiLCJmcmFtZUNvbnRhaW5lciIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50V2luZG93IiwiY29udGVudERvY3VtZW50IiwiX2NsZWFyIiwiY3JlYXRlRWxlbWVudCIsImFwcGVuZENoaWxkIiwicGFyYW1zIiwiZmlsZXMiLCJza2luIiwic3JjIiwib25sb2FkIiwibG9hZCIsInZpc2liaWxpdHkiLCJjYWxsYmFjayIsImZpcnN0Q2hpbGQiLCJyZW1vdmVDaGlsZCIsIk1lc3NhZ2UiLCJtYWluQ29udGFpbmVyIiwibWVzc2FnZUNvbnRhaW5lciIsIl9pbml0Iiwid2FybiIsIm1lc3NhZ2UiLCJfYWN0aXZlIiwiZGlzcGxheSIsInAiLCJmcmFnbWVudCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJpbm5lckhUTUwiLCJsaW5lSGVpZ2h0Iiwid2luZG93IiwicG9seW1lclJlYWR5IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImlkIiwicmVnaXN0ZXIiLCJwcmVmcyIsIm9uY29udGV4dG1lbnUiLCJfZ2FxIiwicHVzaCIsImdhIiwidHlwZSIsImFzeW5jIiwibG9jYXRpb24iLCJwcm90b2NvbCIsInMiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInBhcmVudE5vZGUiLCJpbnNlcnRCZWZvcmUiXSwibWFwcGluZ3MiOiJBQUVBLEdBQXNCLG1CQUFYQSxRQUF3QixDQUNqQyxHQUFJQSxTQUNGQyxLQUFNLGtCQUNOQyxZQUFhLE9BR1Esb0JBQVpDLFVB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InNvdXJjZXNDb250ZW50IjpbIi8qIGdsb2JhbCBjb25maWc6IHRydWUgKi9cbi8qIGV4cG9ydGVkIGNvbmZpZyAqL1xuaWYgKHR5cGVvZiBjb25maWcgPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgdmFyIGNvbmZpZyA9IHtcbiAgICBTS0lOOiBcInNraW4vUlZTa2luLnhtbFwiLFxuICAgIFNUT1JBR0VfRU5WOiBcInByb2RcIlxuICB9O1xuXG4gIGlmICh0eXBlb2YgYW5ndWxhciAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIGFuZ3VsYXIubW9kdWxlKFwicmlzZXZpc2lvbi5jb21tb24uaTE4bi5jb25maWdcIiwgW10pXG4gICAgICAuY29uc3RhbnQoXCJMT0NBTEVTX1BSRUZJWFwiLCBcImxvY2FsZXMvdHJhbnNsYXRpb25fXCIpXG4gICAgICAuY29uc3RhbnQoXCJMT0NBTEVTX1NVRklYXCIsIFwiLmpzb25cIik7XG4gIH1cbn1cblxyXG4vKiBnbG9iYWwgZ2FkZ2V0cywgY29uZmlnICovXG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uVmlkZW8gPSB7fTtcblxuUmlzZVZpc2lvbi5WaWRlbyA9IChmdW5jdGlvbiAoZ2FkZ2V0cykge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgX2FkZGl0aW9uYWxQYXJhbXM7XG5cbiAgdmFyIF9wcmVmcyA9IG51bGwsXG4gICAgX3N0b3JhZ2UgPSBudWxsLFxuICAgIF9tZXNzYWdlID0gbnVsbCxcbiAgICBfZnJhbWVDb250cm9sbGVyID0gbnVsbDtcblxuICB2YXIgX3BsYXliYWNrRXJyb3IgPSBmYWxzZSxcbiAgICBfaXNTdG9yYWdlRmlsZSA9IGZhbHNlLFxuICAgIF92aWV3ZXJQYXVzZWQgPSB0cnVlO1xuXG4gIHZhciBfY3VycmVudEZyYW1lID0gMDtcblxuICB2YXIgX3NlcGFyYXRvciA9IFwiXCIsXG4gICAgX2N1cnJlbnRGaWxlID0gXCJcIjtcblxuICB2YXIgX3JlZnJlc2hEdXJhdGlvbiA9IDkwMDAwMCwgIC8vIDE1IG1pbnV0ZXNcbiAgICBfcmVmcmVzaEludGVydmFsSWQgPSBudWxsO1xuXG4gIHZhciBfbm9GaWxlVGltZXIgPSBudWxsLFxuICAgIF9ub0ZpbGVGbGFnID0gZmFsc2U7XG5cbiAgLypcbiAgICogIFByaXZhdGUgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gX2NsZWFyTm9GaWxlVGltZXIoKSB7XG4gICAgY2xlYXJUaW1lb3V0KF9ub0ZpbGVUaW1lcik7XG4gICAgX25vRmlsZVRpbWVyID0gbnVsbDtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9kb25lKCkge1xuICAgIGdhZGdldHMucnBjLmNhbGwoXCJcIiwgXCJyc2V2ZW50X2RvbmVcIiwgbnVsbCwgX3ByZWZzLmdldFN0cmluZyhcImlkXCIpKTtcblxuICB9XG5cbiAgZnVuY3Rpb24gX3JlYWR5KCkge1xuICAgIGdhZGdldHMucnBjLmNhbGwoXCJcIiwgXCJyc2V2ZW50X3JlYWR5XCIsIG51bGwsIF9wcmVmcy5nZXRTdHJpbmcoXCJpZFwiKSxcbiAgICAgIHRydWUsIHRydWUsIHRydWUsIHRydWUsIHRydWUpO1xuICB9XG5cbiAgZnVuY3Rpb24gX3JlZnJlc2hJbnRlcnZhbChkdXJhdGlvbikge1xuICAgIF9yZWZyZXNoSW50ZXJ2YWxJZCA9IHNldEludGVydmFsKGZ1bmN0aW9uIHZpZGVvUmVmcmVzaCgpIHtcbiAgICAgIC8vIHNldCBuZXcgdmFsdWUgb2Ygbm9uIHJpc2Utc3RvcmFnZSB1cmwgd2l0aCBhIGNhY2hlYnVzdGVyXG4gICAgICBfY3VycmVudEZpbGUgPSBfYWRkaXRpb25hbFBhcmFtcy51cmwgKyBfc2VwYXJhdG9yICsgXCJjYj1cIiArIG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuXG4gICAgICAvLyBpbiBjYXNlIHJlZnJlc2hlZCBmaWxlIGZpeGVzIGFuIGVycm9yIHdpdGggcHJldmlvdXMgZmlsZSwgZW5zdXJlIGZsYWcgaXMgcmVtb3ZlZCBzbyBwbGF5YmFjayBpcyBhdHRlbXB0ZWQgYWdhaW5cbiAgICAgIF9wbGF5YmFja0Vycm9yID0gZmFsc2U7XG5cbiAgICB9LCBkdXJhdGlvbik7XG4gIH1cblxuICBmdW5jdGlvbiBfc3RhcnROb0ZpbGVUaW1lcigpIHtcbiAgICBfY2xlYXJOb0ZpbGVUaW1lcigpO1xuXG4gICAgX25vRmlsZVRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAvLyBub3RpZnkgVmlld2VyIHdpZGdldCBpcyBkb25lXG4gICAgICBfZG9uZSgpO1xuICAgIH0sIDUwMDApO1xuICB9XG5cbiAgLypcbiAgICogIFB1YmxpYyBNZXRob2RzXG4gICAqL1xuICBmdW5jdGlvbiBub1N0b3JhZ2VGaWxlKCkge1xuICAgIF9ub0ZpbGVGbGFnID0gdHJ1ZTtcbiAgICBfY3VycmVudEZpbGUgPSBcIlwiO1xuXG4gICAgX21lc3NhZ2Uuc2hvdyhcIlRoZSBzZWxlY3RlZCB2aWRlbyBkb2VzIG5vdCBleGlzdC5cIik7XG5cbiAgICBfZnJhbWVDb250cm9sbGVyLnJlbW92ZShfY3VycmVudEZyYW1lLCBmdW5jdGlvbiAoKSB7XG4gICAgICAvLyBpZiBXaWRnZXQgaXMgcGxheWluZyByaWdodCBub3csIHJ1biB0aGUgdGltZXJcbiAgICAgIGlmICghX3ZpZXdlclBhdXNlZCkge1xuICAgICAgICBfc3RhcnROb0ZpbGVUaW1lcigpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gb25TdG9yYWdlSW5pdCh1cmwpIHtcbiAgICBfY3VycmVudEZpbGUgPSB1cmw7XG5cbiAgICBfbWVzc2FnZS5oaWRlKCk7XG5cbiAgICBpZiAoIV92aWV3ZXJQYXVzZWQpIHtcbiAgICAgIHBsYXkoKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBvblN0b3JhZ2VSZWZyZXNoKHVybCkge1xuICAgIF9jdXJyZW50RmlsZSA9IHVybDtcblxuICAgIC8vIGluIGNhc2UgcmVmcmVzaGVkIGZpbGUgZml4ZXMgYW4gZXJyb3Igd2l0aCBwcmV2aW91cyBmaWxlLCBlbnN1cmUgZmxhZyBpcyByZW1vdmVkIHNvIHBsYXliYWNrIGlzIGF0dGVtcHRlZCBhZ2FpblxuICAgIF9wbGF5YmFja0Vycm9yID0gZmFsc2U7XG4gIH1cblxuICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICB2YXIgZnJhbWVPYmogPSBfZnJhbWVDb250cm9sbGVyLmdldEZyYW1lT2JqZWN0KF9jdXJyZW50RnJhbWUpO1xuXG4gICAgX3ZpZXdlclBhdXNlZCA9IHRydWU7XG5cbiAgICBpZiAoX25vRmlsZUZsYWcpIHtcbiAgICAgIF9jbGVhck5vRmlsZVRpbWVyKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGZyYW1lT2JqKSB7XG4gICAgICBmcmFtZU9iai5wYXVzZSgpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgdmFyIGZyYW1lT2JqID0gX2ZyYW1lQ29udHJvbGxlci5nZXRGcmFtZU9iamVjdChfY3VycmVudEZyYW1lKTtcblxuICAgIF92aWV3ZXJQYXVzZWQgPSBmYWxzZTtcblxuICAgIGlmIChfbm9GaWxlRmxhZykge1xuICAgICAgX3N0YXJ0Tm9GaWxlVGltZXIoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIV9wbGF5YmFja0Vycm9yKSB7XG4gICAgICBpZiAoZnJhbWVPYmopIHtcbiAgICAgICAgZnJhbWVPYmoucGxheSgpO1xuICAgICAgfSBlbHNlIHtcblxuICAgICAgICBpZiAoX2N1cnJlbnRGaWxlICYmIF9jdXJyZW50RmlsZSAhPT0gXCJcIikge1xuICAgICAgICAgIC8vIGFkZCBmcmFtZSBhbmQgY3JlYXRlIHRoZSBwbGF5ZXJcbiAgICAgICAgICBfZnJhbWVDb250cm9sbGVyLmFkZCgwKTtcbiAgICAgICAgICBfZnJhbWVDb250cm9sbGVyLmNyZWF0ZUZyYW1lUGxheWVyKDAsIF9hZGRpdGlvbmFsUGFyYW1zLCBfY3VycmVudEZpbGUsIGNvbmZpZy5TS0lOLCBcInBsYXllci5odG1sXCIpO1xuICAgICAgICB9XG5cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gVGhpcyBmbGFnIG9ubHkgZ290IHNldCB1cG9uIGEgcmVmcmVzaCBvZiBoaWRkZW4gZnJhbWUgYW5kIHRoZXJlIHdhcyBhbiBlcnJvciBpbiBzZXR1cCBvciB2aWRlb1xuICAgICAgLy8gU2VuZCBWaWV3ZXIgXCJkb25lXCJcbiAgICAgIF9kb25lKCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcGxheWVyRW5kZWQoKSB7XG4gICAgX2ZyYW1lQ29udHJvbGxlci5yZW1vdmUoX2N1cnJlbnRGcmFtZSwgZnVuY3Rpb24gKCkge1xuICAgICAgX2RvbmUoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBsYXllclJlYWR5KCkge1xuICAgIHZhciBmcmFtZU9iajtcblxuICAgIC8vIG5vbi1zdG9yYWdlLCBjaGVjayBpZiByZWZyZXNoIGludGVydmFsIGV4aXN0cyB5ZXQsIHN0YXJ0IGl0IGlmIG5vdFxuICAgIGlmICghX2lzU3RvcmFnZUZpbGUgJiYgX3JlZnJlc2hJbnRlcnZhbElkID09PSBudWxsKSB7XG4gICAgICBfcmVmcmVzaEludGVydmFsKF9yZWZyZXNoRHVyYXRpb24pO1xuICAgIH1cblxuICAgIGlmICghX3ZpZXdlclBhdXNlZCkge1xuICAgICAgZnJhbWVPYmogPSBfZnJhbWVDb250cm9sbGVyLmdldEZyYW1lT2JqZWN0KF9jdXJyZW50RnJhbWUpO1xuICAgICAgZnJhbWVPYmoucGxheSgpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHNldEFkZGl0aW9uYWxQYXJhbXMobmFtZXMsIHZhbHVlcykge1xuICAgIHZhciBzdHI7XG5cbiAgICBpZiAoQXJyYXkuaXNBcnJheShuYW1lcykgJiYgbmFtZXMubGVuZ3RoID4gMCAmJiBuYW1lc1swXSA9PT0gXCJhZGRpdGlvbmFsUGFyYW1zXCIpIHtcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlcykgJiYgdmFsdWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgX2FkZGl0aW9uYWxQYXJhbXMgPSBKU09OLnBhcnNlKHZhbHVlc1swXSk7XG4gICAgICAgIF9wcmVmcyA9IG5ldyBnYWRnZXRzLlByZWZzKCk7XG5cbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ2aWRlb0NvbnRhaW5lclwiKS5zdHlsZS5oZWlnaHQgPSBfcHJlZnMuZ2V0SW50KFwicnNIXCIpICsgXCJweFwiO1xuXG4gICAgICAgIF9hZGRpdGlvbmFsUGFyYW1zLndpZHRoID0gX3ByZWZzLmdldEludChcInJzV1wiKTtcbiAgICAgICAgX2FkZGl0aW9uYWxQYXJhbXMuaGVpZ2h0ID0gX3ByZWZzLmdldEludChcInJzSFwiKTtcblxuICAgICAgICAvL19tZXNzYWdlID0gbmV3IFJpc2VWaXNpb24uQ29tbW9uLk1lc3NhZ2UoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ2aWRlb0NvbnRhaW5lclwiKSxcbiAgICAgICAgLy8gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWVzc2FnZUNvbnRhaW5lclwiKSk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vLy8gc2hvdyB3YWl0IG1lc3NhZ2Ugd2hpbGUgU3RvcmFnZSBpbml0aWFsaXplc1xuICAgICAgICAvL19tZXNzYWdlLnNob3coXCJQbGVhc2Ugd2FpdCB3aGlsZSB5b3VyIHZpZGVvIGlzIGRvd25sb2FkZWQuXCIpO1xuXG4gICAgICAgIF9mcmFtZUNvbnRyb2xsZXIgPSBuZXcgUmlzZVZpc2lvbi5Db21tb24uVmlkZW8uRnJhbWVDb250cm9sbGVyKCk7XG5cbiAgICAgICAgX2lzU3RvcmFnZUZpbGUgPSBmYWxzZTsgLy8oT2JqZWN0LmtleXMoX2FkZGl0aW9uYWxQYXJhbXMuc3RvcmFnZSkubGVuZ3RoICE9PSAwKTtcblxuICAgICAgICBpZiAoIV9pc1N0b3JhZ2VGaWxlKSB7XG4gICAgICAgICAgc3RyID0gX2FkZGl0aW9uYWxQYXJhbXMudXJsLnNwbGl0KFwiP1wiKTtcblxuICAgICAgICAgIC8vIHN0b3JlIHRoaXMgZm9yIHRoZSByZWZyZXNoIHRpbWVyXG4gICAgICAgICAgX3NlcGFyYXRvciA9IChzdHIubGVuZ3RoID09PSAxKSA/IFwiP1wiIDogXCImXCI7XG5cbiAgICAgICAgICBfY3VycmVudEZpbGUgPSBfYWRkaXRpb25hbFBhcmFtcy51cmw7XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBjcmVhdGUgYW5kIGluaXRpYWxpemUgdGhlIFN0b3JhZ2UgbW9kdWxlIGluc3RhbmNlXG4gICAgICAgICAgLy9fc3RvcmFnZSA9IG5ldyBSaXNlVmlzaW9uLlZpZGVvLlN0b3JhZ2UoX2FkZGl0aW9uYWxQYXJhbXMpO1xuICAgICAgICAgIC8vX3N0b3JhZ2UuaW5pdCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgX3JlYWR5KCk7XG5cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwbGF5ZXJFcnJvcihlcnJvcikge1xuICAgIGNvbnNvbGUuZGVidWcoXCJ2aWRlby1mb2xkZXI6OnBsYXllckVycm9yKClcIiwgZXJyb3IpO1xuXG4gICAgLy8gZmxhZyB0aGUgdmlkZW8gaGFzIGFuIGVycm9yXG4gICAgX3BsYXliYWNrRXJyb3IgPSB0cnVlO1xuXG4gICAgLy8gYWN0IGFzIHRob3VnaCB2aWRlbyBoYXMgZW5kZWRcbiAgICBwbGF5ZXJFbmRlZCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gc3RvcCgpIHtcbiAgICBwYXVzZSgpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBcIm5vU3RvcmFnZUZpbGVcIjogbm9TdG9yYWdlRmlsZSxcbiAgICBcIm9uU3RvcmFnZUluaXRcIjogb25TdG9yYWdlSW5pdCxcbiAgICBcIm9uU3RvcmFnZVJlZnJlc2hcIjogb25TdG9yYWdlUmVmcmVzaCxcbiAgICBcInBhdXNlXCI6IHBhdXNlLFxuICAgIFwicGxheVwiOiBwbGF5LFxuICAgIFwic2V0QWRkaXRpb25hbFBhcmFtc1wiOiBzZXRBZGRpdGlvbmFsUGFyYW1zLFxuICAgIFwicGxheWVyRW5kZWRcIjogcGxheWVyRW5kZWQsXG4gICAgXCJwbGF5ZXJSZWFkeVwiOiBwbGF5ZXJSZWFkeSxcbiAgICBcInBsYXllckVycm9yXCI6IHBsYXllckVycm9yLFxuICAgIFwic3RvcFwiOiBzdG9wXG4gIH07XG5cbn0pKGdhZGdldHMpO1xuXHJcbi8qIGdsb2JhbCBjb25maWcgKi9cblxudmFyIFJpc2VWaXNpb24gPSBSaXNlVmlzaW9uIHx8IHt9O1xuUmlzZVZpc2lvbi5WaWRlbyA9IFJpc2VWaXNpb24uVmlkZW8gfHwge307XG5cblJpc2VWaXNpb24uVmlkZW8uU3RvcmFnZSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBfaW5pdGlhbExvYWQgPSB0cnVlO1xuXG4gIC8qXG4gICAqICBQdWJsaWMgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICB2YXIgc3RvcmFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlkZW9TdG9yYWdlXCIpO1xuXG4gICAgaWYgKCFzdG9yYWdlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgc3RvcmFnZS5hZGRFdmVudExpc3RlbmVyKFwicmlzZS1zdG9yYWdlLXJlc3BvbnNlXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIGlmIChlLmRldGFpbCAmJiBlLmRldGFpbC51cmwpIHtcblxuICAgICAgICBpZiAoX2luaXRpYWxMb2FkKSB7XG4gICAgICAgICAgX2luaXRpYWxMb2FkID0gZmFsc2U7XG5cbiAgICAgICAgICBSaXNlVmlzaW9uLlZpZGVvLm9uU3RvcmFnZUluaXQoZS5kZXRhaWwudXJsKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAvLyBjaGVjayBmb3IgXCJjaGFuZ2VkXCIgcHJvcGVydHkgYW5kIGVuc3VyZSBpdCBpcyB0cnVlXG4gICAgICAgICAgaWYgKGUuZGV0YWlsLmhhc093blByb3BlcnR5KFwiY2hhbmdlZFwiKSAmJiBlLmRldGFpbC5jaGFuZ2VkKSB7XG4gICAgICAgICAgICBSaXNlVmlzaW9uLlZpZGVvLm9uU3RvcmFnZVJlZnJlc2goZS5kZXRhaWwudXJsKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHN0b3JhZ2UuYWRkRXZlbnRMaXN0ZW5lcihcInJpc2Utc3RvcmFnZS1uby1maWxlXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgUmlzZVZpc2lvbi5WaWRlby5ub1N0b3JhZ2VGaWxlKCk7XG4gICAgfSk7XG5cbiAgICBzdG9yYWdlLnNldEF0dHJpYnV0ZShcImZvbGRlclwiLCBkYXRhLnN0b3JhZ2UuZm9sZGVyKTtcbiAgICBzdG9yYWdlLnNldEF0dHJpYnV0ZShcImZpbGVOYW1lXCIsIGRhdGEuc3RvcmFnZS5maWxlTmFtZSk7XG4gICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJjb21wYW55SWRcIiwgZGF0YS5zdG9yYWdlLmNvbXBhbnlJZCk7XG4gICAgc3RvcmFnZS5zZXRBdHRyaWJ1dGUoXCJlbnZcIiwgY29uZmlnLlNUT1JBR0VfRU5WKTtcbiAgICBzdG9yYWdlLmdvKCk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIFwiaW5pdFwiOiBpbml0XG4gIH07XG59O1xuXHJcbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcclxuUmlzZVZpc2lvbi5Db21tb24gPSBSaXNlVmlzaW9uLkNvbW1vbiB8fCB7fTtcclxuXHJcblJpc2VWaXNpb24uQ29tbW9uLlZpZGVvID0gUmlzZVZpc2lvbi5Db21tb24uVmlkZW8gfHwge307XHJcblxyXG5SaXNlVmlzaW9uLkNvbW1vbi5WaWRlby5GcmFtZUNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gIHZhciBQUkVGSVggPSBcImlmX1wiO1xyXG5cclxuICBmdW5jdGlvbiBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFBSRUZJWCArIGluZGV4KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGdldEZyYW1lT2JqZWN0KGluZGV4KSB7XHJcbiAgICB2YXIgZnJhbWVDb250YWluZXIgPSBnZXRGcmFtZUNvbnRhaW5lcihpbmRleCksXHJcbiAgICAgIGlmcmFtZTtcclxuXHJcbiAgICBpZnJhbWUgPSBmcmFtZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiaWZyYW1lXCIpO1xyXG5cclxuICAgIGlmIChpZnJhbWUpIHtcclxuICAgICAgcmV0dXJuIChpZnJhbWUuY29udGVudFdpbmRvdykgPyBpZnJhbWUuY29udGVudFdpbmRvdyA6XHJcbiAgICAgICAgKGlmcmFtZS5jb250ZW50RG9jdW1lbnQuZG9jdW1lbnQpID8gaWZyYW1lLmNvbnRlbnREb2N1bWVudC5kb2N1bWVudCA6IGlmcmFtZS5jb250ZW50RG9jdW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBfY2xlYXIoaW5kZXgpIHtcclxuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGdldEZyYW1lQ29udGFpbmVyKGluZGV4KSxcclxuICAgICAgZnJhbWVPYmogPSBnZXRGcmFtZU9iamVjdChpbmRleCksXHJcbiAgICAgIGlmcmFtZTtcclxuXHJcbiAgICBpZiAoZnJhbWVPYmopIHtcclxuICAgICAgaWZyYW1lID0gZnJhbWVDb250YWluZXIucXVlcnlTZWxlY3RvcihcImlmcmFtZVwiKTtcclxuICAgICAgZnJhbWVPYmoucmVtb3ZlKCk7XHJcbiAgICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgXCJhYm91dDpibGFua1wiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGFkZChpbmRleCkge1xyXG4gICAgdmFyIGZyYW1lQ29udGFpbmVyID0gZ2V0RnJhbWVDb250YWluZXIoaW5kZXgpLFxyXG4gICAgICBpZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaWZyYW1lXCIpO1xyXG5cclxuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJhbGxvd1RyYW5zcGFyZW5jeVwiLCB0cnVlKTtcclxuICAgIGlmcmFtZS5zZXRBdHRyaWJ1dGUoXCJmcmFtZWJvcmRlclwiLCBcIjBcIik7XHJcbiAgICBpZnJhbWUuc2V0QXR0cmlidXRlKFwic2Nyb2xsaW5nXCIsIFwibm9cIik7XHJcblxyXG4gICAgZnJhbWVDb250YWluZXIuYXBwZW5kQ2hpbGQoaWZyYW1lKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNyZWF0ZUZyYW1lUGxheWVyKGluZGV4LCBwYXJhbXMsIGZpbGVzLCBza2luLCBzcmMpIHtcclxuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGdldEZyYW1lQ29udGFpbmVyKGluZGV4KSxcclxuICAgICAgZnJhbWVPYmogPSBnZXRGcmFtZU9iamVjdChpbmRleCksXHJcbiAgICAgIGlmcmFtZTtcclxuXHJcbiAgICBpZiAoZnJhbWVPYmopIHtcclxuICAgICAgaWZyYW1lID0gZnJhbWVDb250YWluZXIucXVlcnlTZWxlY3RvcihcImlmcmFtZVwiKTtcclxuXHJcbiAgICAgIGlmcmFtZS5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWZyYW1lLm9ubG9hZCA9IG51bGw7XHJcblxyXG4gICAgICAgIC8vIGluaXRpYWxpemUgYW5kIGxvYWQgdGhlIHBsYXllciBpbnNpZGUgdGhlIGlmcmFtZVxyXG4gICAgICAgIGZyYW1lT2JqLmluaXQocGFyYW1zLCBmaWxlcywgc2tpbik7XHJcbiAgICAgICAgZnJhbWVPYmoubG9hZCgpO1xyXG4gICAgICB9O1xyXG5cclxuICAgICAgaWZyYW1lLnNldEF0dHJpYnV0ZShcInNyY1wiLCBzcmMpO1xyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGhpZGUoaW5kZXgpIHtcclxuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGdldEZyYW1lQ29udGFpbmVyKGluZGV4KTtcclxuXHJcbiAgICBmcmFtZUNvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gXCJoaWRkZW5cIjtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHJlbW92ZShpbmRleCwgY2FsbGJhY2spIHtcclxuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFBSRUZJWCArIGluZGV4KTtcclxuXHJcbiAgICBfY2xlYXIoaW5kZXgpO1xyXG5cclxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAvLyByZW1vdmUgdGhlIGlmcmFtZSBieSBjbGVhcmluZyBhbGwgZWxlbWVudHMgaW5zaWRlIGRpdiBjb250YWluZXJcclxuICAgICAgd2hpbGUgKGZyYW1lQ29udGFpbmVyLmZpcnN0Q2hpbGQpIHtcclxuICAgICAgICBmcmFtZUNvbnRhaW5lci5yZW1vdmVDaGlsZChmcmFtZUNvbnRhaW5lci5maXJzdENoaWxkKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKGNhbGxiYWNrICYmIHR5cGVvZiBjYWxsYmFjayA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgfVxyXG4gICAgfSwgMjAwKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHNob3coaW5kZXgpIHtcclxuICAgIHZhciBmcmFtZUNvbnRhaW5lciA9IGdldEZyYW1lQ29udGFpbmVyKGluZGV4KTtcclxuXHJcbiAgICBmcmFtZUNvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5ID0gXCJ2aXNpYmxlXCI7XHJcbiAgfVxyXG5cclxuICByZXR1cm4ge1xyXG4gICAgYWRkOiBhZGQsXHJcbiAgICBjcmVhdGVGcmFtZVBsYXllcjogY3JlYXRlRnJhbWVQbGF5ZXIsXHJcbiAgICBnZXRGcmFtZUNvbnRhaW5lcjogZ2V0RnJhbWVDb250YWluZXIsXHJcbiAgICBnZXRGcmFtZU9iamVjdDogZ2V0RnJhbWVPYmplY3QsXHJcbiAgICBoaWRlOiBoaWRlLFxyXG4gICAgcmVtb3ZlOiByZW1vdmUsXHJcbiAgICBzaG93OiBzaG93XHJcbiAgfTtcclxufTtcclxuXHJcbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcclxuUmlzZVZpc2lvbi5Db21tb24gPSBSaXNlVmlzaW9uLkNvbW1vbiB8fCB7fTtcclxuXHJcblJpc2VWaXNpb24uQ29tbW9uLk1lc3NhZ2UgPSBmdW5jdGlvbiAobWFpbkNvbnRhaW5lciwgbWVzc2FnZUNvbnRhaW5lcikge1xyXG4gIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICB2YXIgX2FjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICBmdW5jdGlvbiBfaW5pdCgpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIG1lc3NhZ2VDb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gbWFpbkNvbnRhaW5lci5zdHlsZS5oZWlnaHQ7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybihcIkNhbid0IGluaXRpYWxpemUgTWVzc2FnZSAtIFwiLCBlLm1lc3NhZ2UpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLypcclxuICAgKiAgUHVibGljIE1ldGhvZHNcclxuICAgKi9cclxuICBmdW5jdGlvbiBoaWRlKCkge1xyXG4gICAgaWYgKF9hY3RpdmUpIHtcclxuICAgICAgLy8gY2xlYXIgY29udGVudCBvZiBtZXNzYWdlIGNvbnRhaW5lclxyXG4gICAgICB3aGlsZSAobWVzc2FnZUNvbnRhaW5lci5maXJzdENoaWxkKSB7XHJcbiAgICAgICAgbWVzc2FnZUNvbnRhaW5lci5yZW1vdmVDaGlsZChtZXNzYWdlQ29udGFpbmVyLmZpcnN0Q2hpbGQpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBoaWRlIG1lc3NhZ2UgY29udGFpbmVyXHJcbiAgICAgIG1lc3NhZ2VDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG5cclxuICAgICAgLy8gc2hvdyBtYWluIGNvbnRhaW5lclxyXG4gICAgICBtYWluQ29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHkgPSBcInZpc2libGVcIjtcclxuXHJcbiAgICAgIF9hY3RpdmUgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHNob3cobWVzc2FnZSkge1xyXG4gICAgdmFyIGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLFxyXG4gICAgICBwO1xyXG5cclxuICAgIGlmICghX2FjdGl2ZSkge1xyXG4gICAgICAvLyBoaWRlIG1haW4gY29udGFpbmVyXHJcbiAgICAgIG1haW5Db250YWluZXIuc3R5bGUudmlzaWJpbGl0eSA9IFwiaGlkZGVuXCI7XHJcblxyXG4gICAgICBtZXNzYWdlQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcblxyXG4gICAgICAvLyBjcmVhdGUgbWVzc2FnZSBlbGVtZW50XHJcbiAgICAgIHAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcclxuICAgICAgcC5pbm5lckhUTUwgPSBtZXNzYWdlO1xyXG4gICAgICBwLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwibWVzc2FnZVwiKTtcclxuICAgICAgcC5zdHlsZS5saW5lSGVpZ2h0ID0gbWVzc2FnZUNvbnRhaW5lci5zdHlsZS5oZWlnaHQ7XHJcblxyXG4gICAgICBmcmFnbWVudC5hcHBlbmRDaGlsZChwKTtcclxuICAgICAgbWVzc2FnZUNvbnRhaW5lci5hcHBlbmRDaGlsZChmcmFnbWVudCk7XHJcblxyXG4gICAgICBfYWN0aXZlID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIG1lc3NhZ2UgYWxyZWFkeSBiZWluZyBzaG93biwgdXBkYXRlIG1lc3NhZ2UgdGV4dFxyXG4gICAgICBwID0gbWVzc2FnZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLm1lc3NhZ2VcIik7XHJcbiAgICAgIHAuaW5uZXJIVE1MID0gbWVzc2FnZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9pbml0KCk7XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBcImhpZGVcIjogaGlkZSxcclxuICAgIFwic2hvd1wiOiBzaG93XHJcbiAgfTtcclxufTtcclxuXHJcbi8qIGdsb2JhbCBnYWRnZXRzLCBSaXNlVmlzaW9uICovXG5cbihmdW5jdGlvbiAod2luZG93LCBnYWRnZXRzKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuXG4gIHZhciBwcmVmcyA9IG5ldyBnYWRnZXRzLlByZWZzKCksXG4gICAgaWQgPSBwcmVmcy5nZXRTdHJpbmcoXCJpZFwiKTtcblxuICAvLyBEaXNhYmxlIGNvbnRleHQgbWVudSAocmlnaHQgY2xpY2sgbWVudSlcbiAgd2luZG93Lm9uY29udGV4dG1lbnUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgUmlzZVZpc2lvbi5WaWRlby5wbGF5KCk7XG4gIH1cblxuICBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICBSaXNlVmlzaW9uLlZpZGVvLnBhdXNlKCk7XG4gIH1cblxuICBmdW5jdGlvbiBzdG9wKCkge1xuICAgIFJpc2VWaXNpb24uVmlkZW8uc3RvcCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gcG9seW1lclJlYWR5KCkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwiV2ViQ29tcG9uZW50c1JlYWR5XCIsIHBvbHltZXJSZWFkeSk7XG5cbiAgICBpZiAoaWQgJiYgaWQgIT09IFwiXCIpIHtcbiAgICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNjbWRfcGxheV9cIiArIGlkLCBwbGF5KTtcbiAgICAgIGdhZGdldHMucnBjLnJlZ2lzdGVyKFwicnNjbWRfcGF1c2VfXCIgKyBpZCwgcGF1c2UpO1xuICAgICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc2NtZF9zdG9wX1wiICsgaWQsIHN0b3ApO1xuXG4gICAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzcGFyYW1fc2V0X1wiICsgaWQsIFJpc2VWaXNpb24uVmlkZW8uc2V0QWRkaXRpb25hbFBhcmFtcyk7XG4gICAgICBnYWRnZXRzLnJwYy5jYWxsKFwiXCIsIFwicnNwYXJhbV9nZXRcIiwgbnVsbCwgaWQsIFtcImFkZGl0aW9uYWxQYXJhbXNcIl0pO1xuICAgIH1cbiAgfVxuXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiV2ViQ29tcG9uZW50c1JlYWR5XCIsIHBvbHltZXJSZWFkeSk7XG5cbn0pKHdpbmRvdywgZ2FkZ2V0cyk7XG5cblxuXHJcbi8qIGpzaGludCBpZ25vcmU6c3RhcnQgKi9cbnZhciBfZ2FxID0gX2dhcSB8fCBbXTtcblxuX2dhcS5wdXNoKFsnX3NldEFjY291bnQnLCAnVUEtNTcwOTIxNTktMiddKTtcbl9nYXEucHVzaChbJ190cmFja1BhZ2V2aWV3J10pO1xuXG4oZnVuY3Rpb24oKSB7XG4gIHZhciBnYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpOyBnYS50eXBlID0gJ3RleHQvamF2YXNjcmlwdCc7IGdhLmFzeW5jID0gdHJ1ZTtcbiAgZ2Euc3JjID0gKCdodHRwczonID09IGRvY3VtZW50LmxvY2F0aW9uLnByb3RvY29sID8gJ2h0dHBzOi8vc3NsJyA6ICdodHRwOi8vd3d3JykgKyAnLmdvb2dsZS1hbmFseXRpY3MuY29tL2dhLmpzJztcbiAgdmFyIHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2NyaXB0JylbMF07IHMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZ2EsIHMpO1xufSkoKTtcbi8qIGpzaGludCBpZ25vcmU6ZW5kICovXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
